/**
 * almond 0.0.3 Copyright (c) 2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 *//*jslint strict: false, plusplus: false *//*global setTimeout: false */var requirejs,require,define;(function(a){function g(a,b){if(a&&a.charAt(0)==="."&&b){b=b.split("/"),b=b.slice(0,b.length-1),a=b.concat(a.split("/"));var c,d;for(c=0;d=a[c];c++)if(d===".")a.splice(c,1),c-=1;else if(d===".."){if(c===1&&(a[2]===".."||a[0]===".."))break;c>0&&(a.splice(c-1,2),c-=2)}a=a.join("/")}return a}function h(b,c){return function(){return f.apply(a,d.call(arguments,0).concat([b,c]))}}function i(a){return function(b){return g(b,a)}}function j(a){return function(c){b[a]=c}}function k(d){if(c.hasOwnProperty(d)){var f=c[d];delete c[d],e.apply(a,f)}return b[d]}function l(a,b){var c,d,e=a.indexOf("!");return e!==-1?(c=g(a.slice(0,e),b),a=a.slice(e+1),d=k(c),d&&d.normalize?a=d.normalize(a,i(b)):a=g(a,b)):a=g(a,b),{f:c?c+"!"+a:a,n:a,p:d}}var b={},c={},d=[].slice,e,f;if(typeof define=="function")return;e=function(d,e,f,g){var i=[],m,n,o,p,q,r;g||(g=d);if(typeof f=="function"){!e.length&&f.length&&(e=["require","exports","module"]);for(p=0;p<e.length;p++){r=l(e[p],g),o=r.f;if(o==="require")i[p]=h(d);else if(o==="exports")i[p]=b[d]={},m=!0;else if(o==="module")n=i[p]={id:d,uri:"",exports:b[d]};else if(b.hasOwnProperty(o)||c.hasOwnProperty(o))i[p]=k(o);else{if(!r.p)throw d+" missing "+o;r.p.load(r.n,h(g,!0),j(o),{}),i[p]=b[o]}}q=f.apply(b[d],i),d&&(n&&n.exports!==a?b[d]=n.exports:m||(b[d]=q))}else d&&(b[d]=f)},requirejs=f=function(b,c,d,g){return typeof b=="string"?k(l(b,c).f):(b.splice||(c.splice?(b=c,c=arguments[2]):b=[]),g?e(a,b,c,d):setTimeout(function(){e(a,b,c,d)},15),f)},f.config=function(){return f},require||(require=f),define=function(a,b,d){b.splice||(d=b,b=[]),define.unordered?c[a]=[a,b,d]:e(a,b,d)},define.amd={jQuery:!0}})();/*!
 * Joshfire Framework 0.9.1
 * http://framework.joshfire.com/
 *
 * Copyright 2011, Joshfire
 * Dual licensed under the GPL Version 2 and a Commercial license.
 * http://framework.joshfire.com/license
 *
 * Date: Wed Jul 20 20:23:43 2011
 */
/*!
 * Joshfire Framework 0.9.1
 * http://framework.joshfire.com/
 *
 * Copyright 2011, Joshfire
 * Dual licensed under the GPL Version 2 and a Commercial license.
 * http://framework.joshfire.com/license
 *
 * Date: Wed Jul 20 20:23:43 2011
 */
/*!
   * iScroll v4.1.9 ~ Copyright (c) 2011 Matteo Spinelli, http://cubiq.org
   * Released under MIT license, http://cubiq.org/license
   */
1,function(){var a;typeof Joshfire=="undefined"&&(Joshfire={}),a={version:[0,9,3],onReady:function(a){a()},adapter:"ios",adapterModules:{android:["app","dependencies.json","inputs/touch","ui/toolbar","uielements/list","uielements/panel","uielements/video.mediaelement","vendor/iscroll"],browser:["app","inputs/http","inputs/keyboard","inputs/mouse","uielement","uielements/list","uielements/mediacontrols","uielements/page","uielements/panel","uielements/panel.manager","uielements/video.mediaelement","uielements/video.popup","uielements/video.youtube.swf","utils/activitymonitor","utils/datasource","utils/localstorage","utils/navigation","utils/stresstest"],googletv:["dependencies.json","inputs/keyboard","ui/videoplayer","uielement"],ios:["dependencies.json"],lgtv:["dependencies.json","ui/videoplayer","uielement","utils/dollar"],node:["app.factory","app","class","global.exec","inputs/http","uielement","uielements/page","uielements/panel","uielements/panel.manager","uielements/video.mediaelement","utils/datasource","utils/eventsocket","utils/templatecompiler.cli","utils/templatecompiler","vendor/json2"],none:[],philips:["dependencies.json","ui/videoplayer","uielement","uielements/list","uielements/video.mediaelement","utils/dollar","utils/stresstest"],phone:["collection","ui/toolbar","uielement","utils/dollar","utils/onready"],qt4:[],samsungtv:["dependencies.json","inputs/remote","ui/videoplayer","uielement","uielements/map","uielements/video.mediaelement","utils/dollar","utils/navigationhelper","utils/samsungAPIs"],tv:["inputs/remote","ui/cardpanel","ui/grid","ui/horizontallayout","ui/slidepanel","ui/toolbar","ui/verticallist","ui/videoplayer","uielement"]},adapterDeps:["phone"],debug:!1,path:(Joshfire.framework||{}).path||"joshfire"};if(typeof document!="undefined"){var b=document.getElementsByTagName("script"),c,d=new RegExp("^(.*)/adapters/"+a.adapter+"/bootstrap.js$");for(var e=b.length-1;e>=0;e--)c=d.exec(b[e].getAttribute("src")),c&&(a.path=c[1])}typeof require!="undefined"&&require.config&&require.config({paths:{"joshfire-framework":a.path},urlArgs:Joshfire.debug?"bust="+(new Date).getTime():""}),Joshfire.framework=a,typeof module!="undefined"&&module.exports&&(module.exports.JoshfireFramework=a)}.call(this),function(a){a.onReady=function(b){a.require(["joshfire/vendor/zepto"],function(a){b.call()})}}(Joshfire),define("joshlib",{normalize:function(a,b){var c=[Joshfire.framework.adapter].concat(Joshfire.framework.adapterDeps),d=Joshfire.framework.adapterModules,e="joshfire-framework/";if(a.substring(0,14)=="adapters/none/")return e+a.substring(14);if(a.substring(0,9)=="adapters/")return e+a;for(var f=0;f<c.length;f++)for(var g=0;g<d[c[f]].length;g++)if(a==d[c[f]][g])return e+"adapters/"+c[f]+"/"+a;return e+a},load:function(a,b,c,d){b([a],function(a){c(a)})}}),define("joshfire-framework/adapters/phone/utils/onready",[],function(){return function(a){/complete|loaded|interactive/.test(document.readyState)&&a(),document.addEventListener("DOMContentLoaded",a,!1)}}),define("joshfire-framework/vendor/zepto",[],function(){(function(a){String.prototype.trim===a&&(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}),Array.prototype.reduce===a&&(Array.prototype.reduce=function(b){if(this===void 0||this===null)throw new TypeError;var c=Object(this),d=c.length>>>0,e=0,f;if(typeof b!="function")throw new TypeError;if(d==0&&arguments.length==1)throw new TypeError;if(arguments.length>=2)f=arguments[1];else do{if(e in c){f=c[e++];break}if(++e>=d)throw new TypeError}while(!0);while(e<d)e in c&&(f=b.call(a,f,c[e],e,c)),e++;return f})})();var Zepto=function(){function A(a){return v.call(a)=="[object Function]"}function B(a){return a instanceof Object}function C(b){var c,d;if(v.call(b)!=="[object Object]")return!1;d=A(b.constructor)&&b.constructor.prototype;if(!d||!hasOwnProperty.call(d,"isPrototypeOf"))return!1;for(c in b);return c===a||hasOwnProperty.call(b,c)}function D(a){return a instanceof Array}function E(a){return typeof a.length=="number"}function F(b){return b.filter(function(b){return b!==a&&b!==null})}function G(a){return a.length>0?[].concat.apply([],a):a}function H(a){return a.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function I(a){return a in i?i[a]:i[a]=new RegExp("(^|\\s)"+a+"(\\s|$)")}function J(a,b){return typeof b=="number"&&!k[H(a)]?b+"px":b}function K(a){var b,c;return h[a]||(b=g.createElement(a),g.body.appendChild(b),c=j(b,"").getPropertyValue("display"),b.parentNode.removeChild(b),c=="none"&&(c="block"),h[a]=c),h[a]}function L(b,d){return d===a?c(b):c(b).filter(d)}function M(a,b,c,d){return A(b)?b.call(a,c,d):b}function N(a,b,d){var e=a%2?b:b.parentNode;e?e.insertBefore(d,a?a==1?e.firstChild:a==2?b:null:b.nextSibling):c(d).remove()}function O(a,b){b(a);for(var c in a.childNodes)O(a.childNodes[c],b)}var a,b,c,d,e=[],f=e.slice,g=window.document,h={},i={},j=g.defaultView.getComputedStyle,k={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},l=/^\s*<(\w+|!)[^>]*>/,m=[1,3,8,9,11],n=["after","prepend","before","append"],o=g.createElement("table"),p=g.createElement("tr"),q={tr:g.createElement("tbody"),tbody:o,thead:o,tfoot:o,td:p,th:p,"*":g.createElement("div")},r=/complete|loaded|interactive/,s=/^\.([\w-]+)$/,t=/^#([\w-]+)$/,u=/^[\w-]+$/,v={}.toString,w={},x,y,z=g.createElement("div");return w.matches=function(a,b){if(!a||a.nodeType!==1)return!1;var c=a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.matchesSelector;if(c)return c.call(a,b);var d,e=a.parentNode,f=!e;return f&&(e=z).appendChild(a),d=~w.qsa(e,b).indexOf(a),f&&z.removeChild(a),d},x=function(a){return a.replace(/-+(.)?/g,function(a,b){return b?b.toUpperCase():""})},y=function(a){return a.filter(function(b,c){return a.indexOf(b)==c})},w.fragment=function(b,d){d===a&&(d=l.test(b)&&RegExp.$1),d in q||(d="*");var e=q[d];return e.innerHTML=""+b,c.each(f.call(e.childNodes),function(){e.removeChild(this)})},w.Z=function(a,b){return a=a||[],a.__proto__=arguments.callee.prototype,a.selector=b||"",a},w.isZ=function(a){return a instanceof w.Z},w.init=function(b,d){if(!b)return w.Z();if(A(b))return c(g).ready(b);if(w.isZ(b))return b;var e;if(D(b))e=F(b);else if(C(b))e=[c.extend({},b)],b=null;else if(m.indexOf(b.nodeType)>=0||b===window)e=[b],b=null;else if(l.test(b))e=w.fragment(b.trim(),RegExp.$1),b=null;else{if(d!==a)return c(d).find(b);e=w.qsa(g,b)}return w.Z(e,b)},c=function(a,b){return w.init(a,b)},c.extend=function(c){return f.call(arguments,1).forEach(function(d){for(b in d)d[b]!==a&&(c[b]=d[b])}),c},w.qsa=function(a,b){var c;return a===g&&t.test(b)?(c=a.getElementById(RegExp.$1))?[c]:e:a.nodeType!==1&&a.nodeType!==9?e:f.call(s.test(b)?a.getElementsByClassName(RegExp.$1):u.test(b)?a.getElementsByTagName(b):a.querySelectorAll(b))},c.isFunction=A,c.isObject=B,c.isArray=D,c.isPlainObject=C,c.inArray=function(a,b,c){return e.indexOf.call(b,a,c)},c.trim=function(a){return a.trim()},c.uuid=0,c.map=function(a,b){var c,d=[],e,f;if(E(a))for(e=0;e<a.length;e++)c=b(a[e],e),c!=null&&d.push(c);else for(f in a)c=b(a[f],f),c!=null&&d.push(c);return G(d)},c.each=function(a,b){var c,d;if(E(a)){for(c=0;c<a.length;c++)if(b.call(a[c],c,a[c])===!1)return a}else for(d in a)if(b.call(a[d],d,a[d])===!1)return a;return a},c.fn={forEach:e.forEach,reduce:e.reduce,push:e.push,indexOf:e.indexOf,concat:e.concat,map:function(a){return c.map(this,function(b,c){return a.call(b,c,b)})},slice:function(){return c(f.apply(this,arguments))},ready:function(a){return r.test(g.readyState)?a(c):g.addEventListener("DOMContentLoaded",function(){a(c)},!1),this},get:function(b){return b===a?f.call(this):this[b]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){this.parentNode!=null&&this.parentNode.removeChild(this)})},each:function(a){return this.forEach(function(b,c){a.call(b,c,b)}),this},filter:function(a){return c([].filter.call(this,function(b){return w.matches(b,a)}))},add:function(a,b){return c(y(this.concat(c(a,b))))},is:function(a){return this.length>0&&w.matches(this[0],a)},not:function(b){var d=[];if(A(b)&&b.call!==a)this.each(function(a){b.call(this,a)||d.push(this)});else{var e=typeof b=="string"?this.filter(b):E(b)&&A(b.item)?f.call(b):c(b);this.forEach(function(a){e.indexOf(a)<0&&d.push(a)})}return c(d)},eq:function(a){return a===-1?this.slice(a):this.slice(a,+a+1)},first:function(){var a=this[0];return a&&!B(a)?a:c(a)},last:function(){var a=this[this.length-1];return a&&!B(a)?a:c(a)},find:function(a){var b;return this.length==1?b=w.qsa(this[0],a):b=this.map(function(){return w.qsa(this,a)}),c(b)},closest:function(a,b){var d=this[0];while(d&&!w.matches(d,a))d=d!==b&&d!==g&&d.parentNode;return c(d)},parents:function(a){var b=[],d=this;while(d.length>0)d=c.map(d,function(a){if((a=a.parentNode)&&a!==g&&b.indexOf(a)<0)return b.push(a),a});return L(b,a)},parent:function(a){return L(y(this.pluck("parentNode")),a)},children:function(a){return L(this.map(function(){return f.call(this.children)}),a)},siblings:function(a){return L(this.map(function(a,b){return f.call(b.parentNode.children).filter(function(a){return a!==b})}),a)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(a){return this.map(function(){return this[a]})},show:function(){return this.each(function(){this.style.display=="none"&&(this.style.display=null),j(this,"").getPropertyValue("display")=="none"&&(this.style.display=K(this.nodeName))})},replaceWith:function(a){return this.before(a).remove()},wrap:function(a){return this.each(function(){c(this).wrapAll(c(a)[0].cloneNode(!1))})},wrapAll:function(a){return this[0]&&(c(this[0]).before(a=c(a)),a.append(this)),this},unwrap:function(){return this.parent().each(function(){c(this).replaceWith(c(this).children())}),this},clone:function(){return c(this.map(function(){return this.cloneNode(!0)}))},hide:function(){return this.css("display","none")},toggle:function(b){return(b===a?this.css("display")=="none":b)?this.show():this.hide()},prev:function(){return c(this.pluck("previousElementSibling"))},next:function(){return c(this.pluck("nextElementSibling"))},html:function(b){return b===a?this.length>0?this[0].innerHTML:null:this.each(function(a){var d=this.innerHTML;c(this).empty().append(M(this,b,a,d))})},text:function(b){return b===a?this.length>0?this[0].textContent:null:this.each(function(){this.textContent=b})},attr:function(c,d){var e;return typeof c=="string"&&d===a?this.length==0||this[0].nodeType!==1?a:c=="value"&&this[0].nodeName=="INPUT"?this.val():!(e=this[0].getAttribute(c))&&c in this[0]?this[0][c]:e:this.each(function(a){if(this.nodeType!==1)return;if(B(c))for(b in c)this.setAttribute(b,c[b]);else this.setAttribute(c,M(this,d,a,this.getAttribute(c)))})},removeAttr:function(a){return this.each(function(){this.nodeType===1&&this.removeAttribute(a)})},prop:function(b,c){return c===a?this[0]?this[0][b]:a:this.each(function(a){this[b]=M(this,c,a,this[b])})},data:function(b,c){var d=this.attr("data-"+H(b),c);return d!==null?d:a},val:function(b){return b===a?this.length>0?this[0].value:a:this.each(function(a){this.value=M(this,b,a,this.value)})},offset:function(){if(this.length==0)return null;var a=this[0].getBoundingClientRect();return{left:a.left+window.pageXOffset,top:a.top+window.pageYOffset,width:a.width,height:a.height}},css:function(c,d){if(d===a&&typeof c=="string")return this.length==0?a:this[0].style[x(c)]||j(this[0],"").getPropertyValue(c);var e="";for(b in c)typeof c[b]=="string"&&c[b]==""?this.each(function(){this.style.removeProperty(H(b))}):e+=H(b)+":"+J(b,c[b])+";";return typeof c=="string"&&(d==""?this.each(function(){this.style.removeProperty(H(c))}):e=H(c)+":"+J(c,d)),this.each(function(){this.style.cssText+=";"+e})},index:function(a){return a?this.indexOf(c(a)[0]):this.parent().children().indexOf(this[0])},hasClass:function(a){return this.length<1?!1:I(a).test(this[0].className)},addClass:function(a){return this.each(function(b){d=[];var e=this.className,f=M(this,a,b,e);f.split(/\s+/g).forEach(function(a){c(this).hasClass(a)||d.push(a)},this),d.length&&(this.className+=(e?" ":"")+d.join(" "))})},removeClass:function(b){return this.each(function(c){if(b===a)return this.className="";d=this.className,M(this,b,c,d).split(/\s+/g).forEach(function(a){d=d.replace(I(a)," ")}),this.className=d.trim()})},toggleClass:function(b,d){return this.each(function(e){var f=M(this,b,e,this.className);(d===a?!c(this).hasClass(f):d)?c(this).addClass(f):c(this).removeClass(f)})}},["width","height"].forEach(function(b){c.fn[b]=function(d){var e,f=b.replace(/./,function(a){return a[0].toUpperCase()});return d===a?this[0]==window?window["inner"+f]:this[0]==g?g.documentElement["offset"+f]:(e=this.offset())&&e[b]:this.each(function(a){var e=c(this);e.css(b,M(this,d,a,e[b]()))})}}),n.forEach(function(a,b){c.fn[a]=function(){var a=c.map(arguments,function(a){return B(a)?a:w.fragment(a)});if(a.length<1)return this;var d=this.length,e=d>1,f=b<2;return this.each(function(c,g){for(var h=0;h<a.length;h++){var i=a[f?a.length-h-1:h];O(i,function(a){a.nodeName!=null&&a.nodeName.toUpperCase()==="SCRIPT"&&(!a.type||a.type==="text/javascript")&&window.eval.call(window,a.innerHTML)}),e&&c<d-1&&(i=i.cloneNode(!0)),N(b,g,i)}})},c.fn[b%2?a+"To":"insert"+(b?"Before":"After")]=function(b){return c(b)[a](this),this}}),w.Z.prototype=c.fn,w.camelize=x,w.uniq=y,c.zepto=w,c}();return window.Zepto=Zepto,"$"in window||(window.$=Zepto),function(a){function f(a){return a._zid||(a._zid=d++)}function g(a,b,d,e){b=h(b);if(b.ns)var g=i(b.ns);return(c[f(a)]||[]).filter(function(a){return a&&(!b.e||a.e==b.e)&&(!b.ns||g.test(a.ns))&&(!d||f(a.fn)===f(d))&&(!e||a.sel==e)})}function h(a){var b=(""+a).split(".");return{e:b[0],ns:b.slice(1).sort().join(" ")}}function i(a){return new RegExp("(?:^| )"+a.replace(" "," .* ?")+"(?: |$)")}function j(b,c,d){a.isObject(b)?a.each(b,d):b.split(/\s/).forEach(function(a){d(a,c)})}function k(b,d,e,g,i,k){k=!!k;var l=f(b),m=c[l]||(c[l]=[]);j(d,e,function(c,d){var e=i&&i(d,c),f=e||d,j=function(a){var c=f.apply(b,[a].concat(a.data));return c===!1&&a.preventDefault(),c},l=a.extend(h(c),{fn:d,proxy:j,sel:g,del:e,i:m.length});m.push(l),b.addEventListener(l.e,j,k)})}function l(a,b,d,e){var h=f(a);j(b||"",d,function(b,d){g(a,b,d,e).forEach(function(b){delete c[h][b.i],a.removeEventListener(b.e,b.proxy,!1)})})}function p(b){var c=a.extend({originalEvent:b},b);return a.each(o,function(a,d){c[a]=function(){return this[d]=m,b[a].apply(b,arguments)},c[d]=n}),c}function q(a){if(!("defaultPrevented"in a)){a.defaultPrevented=!1;var b=a.preventDefault;a.preventDefault=function(){this.defaultPrevented=!0,b.call(this)}}}var b=a.zepto.qsa,c={},d=1,e={};e.click=e.mousedown=e.mouseup=e.mousemove="MouseEvents",a.event={add:k,remove:l},a.proxy=function(b,c){if(a.isFunction(b)){var d=function(){return b.apply(c,arguments)};return d._zid=f(b),d}if(typeof c=="string")return a.proxy(b[c],b);throw new TypeError("expected function")},a.fn.bind=function(a,b){return this.each(function(){k(this,a,b)})},a.fn.unbind=function(a,b){return this.each(function(){l(this,a,b)})},a.fn.one=function(a,b){return this.each(function(c,d){k(this,a,b,null,function(a,b){return function(){var c=a.apply(d,arguments);return l(d,b,a),c}})})};var m=function(){return!0},n=function(){return!1},o={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};a.fn.delegate=function(b,c,d){var e=!1;if(c=="blur"||c=="focus")a.iswebkit?c=c=="blur"?"focusout":c=="focus"?"focusin":c:e=!0;return this.each(function(f,g){k(g,c,d,b,function(c){return function(d){var e,f=a(d.target).closest(b,g).get(0);if(f)return e=a.extend(p(d),{currentTarget:f,liveFired:g}),c.apply(f,[e].concat([].slice.call(arguments,1)))}},e)})},a.fn.undelegate=function(a,b,c){return this.each(function(){l(this,b,c,a)})},a.fn.live=function(b,c){return a(document.body).delegate(this.selector,b,c),this},a.fn.die=function(b,c){return a(document.body).undelegate(this.selector,b,c),this},a.fn.on=function(b,c,d){return c==undefined||a.isFunction(c)?this.bind(b,c):this.delegate(c,b,d)},a.fn.off=function(b,c,d){return c==undefined||a.isFunction(c)?this.unbind(b,c):this.undelegate(c,b,d)},a.fn.trigger=function(b,c){return typeof b=="string"&&(b=a.Event(b)),q(b),b.data=c,this.each(function(){"dispatchEvent"in this&&this.dispatchEvent(b)})},a.fn.triggerHandler=function(b,c){var d,e;return this.each(function(f,h){d=p(typeof b=="string"?a.Event(b):b),d.data=c,d.target=h,a.each(g(h,b.type||b),function(a,b){e=b.proxy(d);if(d.isImmediatePropagationStopped())return!1})}),e},"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout change select keydown keypress keyup error".split(" ").forEach(function(b){a.fn[b]=function(a){return this.bind(b,a)}}),["focus","blur"].forEach(function(b){a.fn[b]=function(a){if(a)this.bind(b,a);else if(this.length)try{this.get(0)[b]()}catch(c){}return this}}),a.Event=function(a,b){var c=document.createEvent(e[a]||"Events"),d=!0;if(b)for(var f in b)f=="bubbles"?d=!!b[f]:c[f]=b[f];return c.initEvent(a,d,!0,null,null,null,null,null,null,null,null,null,null,null,null),c}}(Zepto),function(a){function b(a){var b=this.os={},c=this.browser={},d=a.match(/WebKit\/([\d.]+)/),e=a.match(/(Android)\s+([\d.]+)/),f=a.match(/(iPad).*OS\s([\d_]+)/),g=!f&&a.match(/(iPhone\sOS)\s([\d_]+)/),h=a.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),i=h&&a.match(/TouchPad/),j=a.match(/Kindle\/([\d.]+)/),k=a.match(/Silk\/([\d._]+)/),l=a.match(/(BlackBerry).*Version\/([\d.]+)/);if(c.webkit=!!d)c.version=d[1];e&&(b.android=!0,b.version=e[2]),g&&(b.ios=b.iphone=!0,b.version=g[2].replace(/_/g,".")),f&&(b.ios=b.ipad=!0,b.version=f[2].replace(/_/g,".")),h&&(b.webos=!0,b.version=h[2]),i&&(b.touchpad=!0),l&&(b.blackberry=!0,b.version=l[2]),j&&(b.kindle=!0,b.version=j[1]),k&&(c.silk=!0,c.version=k[1]),!k&&b.android&&a.match(/Kindle Fire/)&&(c.silk=!0)}b.call(a,navigator.userAgent),a.__detect=b}(Zepto),function(a,b){function l(a){return a.toLowerCase()}function m(a){return d?d+a:l(a)}var c="",d,e,f,g={Webkit:"webkit",Moz:"",O:"o",ms:"MS"},h=window.document,i=h.createElement("div"),j=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,k={};a.each(g,function(a,e){if(i.style[a+"TransitionProperty"]!==b)return c="-"+l(a)+"-",d=e,!1}),k[c+"transition-property"]=k[c+"transition-duration"]=k[c+"transition-timing-function"]=k[c+"animation-name"]=k[c+"animation-duration"]="",a.fx={off:d===b&&i.style.transitionProperty===b,cssPrefix:c,transitionEnd:m("TransitionEnd"),animationEnd:m("AnimationEnd")},a.fn.animate=function(b,c,d,e){return a.isObject(c)&&(d=c.easing,e=c.complete,c=c.duration),c&&(c/=1e3),this.anim(b,c,d,e)},a.fn.anim=function(d,e,f,g){var h,i={},l,m=this,n,o=a.fx.transitionEnd;e===b&&(e=.4),a.fx.off&&(e=0);if(typeof d=="string")i[c+"animation-name"]=d,i[c+"animation-duration"]=e+"s",o=a.fx.animationEnd;else{for(l in d)j.test(l)?(h||(h=[]),h.push(l+"("+d[l]+")")):i[l]=d[l];h&&(i[c+"transform"]=h.join(" ")),!a.fx.off&&typeof d=="object"&&(i[c+"transition-property"]=Object.keys(d).join(", "),i[c+"transition-duration"]=e+"s",i[c+"transition-timing-function"]=f||"linear")}return n=function(b){if(typeof b!="undefined"){if(b.target!==b.currentTarget)return;a(b.target).unbind(o,arguments.callee)}a(this).css(k),g&&g.call(this)},e>0&&this.bind(o,n),setTimeout(function(){m.css(i),e<=0&&setTimeout(function(){m.each(function(){n.call(this)})},0)},0),this},i=null}(Zepto),function($){function triggerAndReturn(a,b,c){var d=$.Event(b);return $(a).trigger(d,c),!d.defaultPrevented}function triggerGlobal(a,b,c,d){if(a.global)return triggerAndReturn(b||document,c,d)}function ajaxStart(a){a.global&&$.active++===0&&triggerGlobal(a,null,"ajaxStart")}function ajaxStop(a){a.global&&!--$.active&&triggerGlobal(a,null,"ajaxStop")}function ajaxBeforeSend(a,b){var c=b.context;if(b.beforeSend.call(c,a,b)===!1||triggerGlobal(b,c,"ajaxBeforeSend",[a,b])===!1)return!1;triggerGlobal(b,c,"ajaxSend",[a,b])}function ajaxSuccess(a,b,c){var d=c.context,e="success";c.success.call(d,a,e,b),triggerGlobal(c,d,"ajaxSuccess",[b,c,a]),ajaxComplete(e,b,c)}function ajaxError(a,b,c,d){var e=d.context;d.error.call(e,c,b,a),triggerGlobal(d,e,"ajaxError",[c,d,a]),ajaxComplete(b,c,d)}function ajaxComplete(a,b,c){var d=c.context;c.complete.call(d,b,a),triggerGlobal(c,d,"ajaxComplete",[b,c]),ajaxStop(c)}function empty(){}function mimeToDataType(a){return a&&(a==htmlType?"html":a==jsonType?"json":scriptTypeRE.test(a)?"script":xmlTypeRE.test(a)&&"xml")||"text"}function appendQuery(a,b){return(a+"&"+b).replace(/[&?]{1,2}/,"?")}function serializeData(a){isObject(a.data)&&(a.data=$.param(a.data)),a.data&&(!a.type||a.type.toUpperCase()=="GET")&&(a.url=appendQuery(a.url,a.data))}function serialize(a,b,c,d){var e=$.isArray(b);$.each(b,function(b,f){d&&(b=c?d:d+"["+(e?"":b)+"]"),!d&&e?a.add(f.name,f.value):(c?$.isArray(f):isObject(f))?serialize(a,f,c,b):a.add(b,f)})}var jsonpID=0,isObject=$.isObject,document=window.document,key,name,rscript=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,scriptTypeRE=/^(?:text|application)\/javascript/i,xmlTypeRE=/^(?:text|application)\/xml/i,jsonType="application/json",htmlType="text/html",blankRE=/^\s*$/;$.active=0,$.ajaxJSONP=function(a){var b="jsonp"+ ++jsonpID,c=document.createElement("script"),d=function(){$(c).remove(),b in window&&(window[b]=empty),ajaxComplete("abort",e,a)},e={abort:d},f;return a.error&&(c.onerror=function(){e.abort(),a.error()}),window[b]=function(d){clearTimeout(f),$(c).remove(),delete window[b],ajaxSuccess(d,e,a)},serializeData(a),c.src=a.url.replace(/=\?/,"="+b),$("head").append(c),a.timeout>0&&(f=setTimeout(function(){e.abort(),ajaxComplete("timeout",e,a)},a.timeout)),e},$.ajaxSettings={type:"GET",beforeSend:empty,success:empty,error:empty,complete:empty,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript",json:jsonType,xml:"application/xml, text/xml",html:htmlType,text:"text/plain"},crossDomain:!1,timeout:0},$.ajax=function(options){var settings=$.extend({},options||{});for(key in $.ajaxSettings)settings[key]===undefined&&(settings[key]=$.ajaxSettings[key]);ajaxStart(settings),settings.crossDomain||(settings.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(settings.url)&&RegExp.$2!=window.location.host);var dataType=settings.dataType,hasPlaceholder=/=\?/.test(settings.url);if(dataType=="jsonp"||hasPlaceholder)return hasPlaceholder||(settings.url=appendQuery(settings.url,"callback=?")),$.ajaxJSONP(settings);settings.url||(settings.url=window.location.toString()),serializeData(settings);var mime=settings.accepts[dataType],baseHeaders={},protocol=/^([\w-]+:)\/\//.test(settings.url)?RegExp.$1:window.location.protocol,xhr=$.ajaxSettings.xhr(),abortTimeout;settings.crossDomain||(baseHeaders["X-Requested-With"]="XMLHttpRequest"),mime&&(baseHeaders.Accept=mime,mime.indexOf(",")>-1&&(mime=mime.split(",",2)[0]),xhr.overrideMimeType&&xhr.overrideMimeType(mime));if(settings.contentType||settings.data&&settings.type.toUpperCase()!="GET")baseHeaders["Content-Type"]=settings.contentType||"application/x-www-form-urlencoded";settings.headers=$.extend(baseHeaders,settings.headers||{}),xhr.onreadystatechange=function(){if(xhr.readyState==4){clearTimeout(abortTimeout);var result,error=!1;if(xhr.status>=200&&xhr.status<300||xhr.status==304||xhr.status==0&&protocol=="file:"){dataType=dataType||mimeToDataType(xhr.getResponseHeader("content-type")),result=xhr.responseText;try{dataType=="script"?(1,eval)(result):dataType=="xml"?result=xhr.responseXML:dataType=="json"&&(result=blankRE.test(result)?null:JSON.parse(result))}catch(e){error=e}error?ajaxError(error,"parsererror",xhr,settings):ajaxSuccess(result,xhr,settings)}else ajaxError(null,"error",xhr,settings)}};var async="async"in settings?settings.async:!0;xhr.open(settings.type,settings.url,async);for(name in settings.headers)xhr.setRequestHeader(name,settings.headers[name]);return ajaxBeforeSend(xhr,settings)===!1?(xhr.abort(),!1):(settings.timeout>0&&(abortTimeout=setTimeout(function(){xhr.onreadystatechange=empty,xhr.abort(),ajaxError(null,"timeout",xhr,settings)},settings.timeout)),xhr.send(settings.data?settings.data:null),xhr)},$.get=function(a,b){return $.ajax({url:a,success:b})},$.post=function(a,b,c,d){return $.isFunction(b)&&(d=d||c,c=b,b=null),$.ajax({type:"POST",url:a,data:b,success:c,dataType:d})},$.getJSON=function(a,b){return $.ajax({url:a,success:b,dataType:"json"})},$.fn.load=function(a,b){if(!this.length)return this;var c=this,d=a.split(/\s/),e;return d.length>1&&(a=d[0],e=d[1]),$.get(a,function(a){c.html(e?$(document.createElement("div")).html(a.replace(rscript,"")).find(e).html():a),b&&b.call(c)}),this};var escape=encodeURIComponent;$.param=function(a,b){var c=[];return c.add=function(a,b){this.push(escape(a)+"="+escape(b))},serialize(c,a,b),c.join("&").replace("%20","+")}}(Zepto),function(a){a.fn.serializeArray=function(){var b=[],c;return a(Array.prototype.slice.call(this.get(0).elements)).each(function(){c=a(this);var d=c.attr("type");this.nodeName.toLowerCase()!="fieldset"&&!this.disabled&&d!="submit"&&d!="reset"&&d!="button"&&(d!="radio"&&d!="checkbox"||this.checked)&&b.push({name:c.attr("name"),value:c.val()})}),b},a.fn.serialize=function(){var a=[];return this.serializeArray().forEach(function(b){a.push(encodeURIComponent(b.name)+"="+encodeURIComponent(b.value))}),a.join("&")},a.fn.submit=function(b){if(b)this.bind("submit",b);else if(this.length){var c=a.Event("submit");this.eq(0).trigger(c),c.defaultPrevented||this.get(0).submit()}return this}}(Zepto),function(a){function d(a){return"tagName"in a?a:a.parentNode}function e(a,b,c,d){var e=Math.abs(a-b),f=Math.abs(c-d);return e>=f?a-b>0?"Left":"Right":c-d>0?"Up":"Down"}function h(){g=null,b.last&&(b.el.trigger("longTap"),b={})}function i(){g&&clearTimeout(g),g=null}var b={},c,f=750,g;a(document).ready(function(){var j,k;a(document.body).bind("touchstart",function(e){j=Date.now(),k=j-(b.last||j),b.el=a(d(e.touches[0].target)),c&&clearTimeout(c),b.x1=e.touches[0].pageX,b.y1=e.touches[0].pageY,k>0&&k<=250&&(b.isDoubleTap=!0),b.last=j,g=setTimeout(h,f)}).bind("touchmove",function(a){i(),b.x2=a.touches[0].pageX,b.y2=a.touches[0].pageY}).bind("touchend",function(a){i(),b.isDoubleTap?(b.el.trigger("doubleTap"),b={}):b.x2&&Math.abs(b.x1-b.x2)>30||b.y2&&Math.abs(b.y1-b.y2)>30?(b.el.trigger("swipe")&&b.el.trigger("swipe"+e(b.x1,b.x2,b.y1,b.y2)),b={}):"last"in b&&(b.el.trigger("tap"),c=setTimeout(function(){c=null,b.el.trigger("singleTap"),b={}},250))}).bind("touchcancel",function(){c&&clearTimeout(c),g&&clearTimeout(g),g=c=null,b={}})}),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach(function(b){a.fn[b]=function(a){return this.bind(b,a)}})}(Zepto),Zepto}),define("joshfire-framework/adapters/phone/utils/dollar",["joshlib!vendor/zepto"],function(a){return a}),define("joshfire-framework/vendor/underscore",[],function(){function B(a,b,c){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;a._chain&&(a=a._wrapped),b._chain&&(b=b._wrapped);if(a.isEqual&&x.isFunction(a.isEqual))return a.isEqual(b);if(b.isEqual&&x.isFunction(b.isEqual))return b.isEqual(a);var d=j.call(a);if(d!=j.call(b))return!1;switch(d){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object")return!1;var e=c.length;while(e--)if(c[e]==a)return!0;c.push(a);var f=0,g=!0;if(d=="[object Array]"){f=a.length,g=f==b.length;if(g)while(f--)if(!(g=f in a==f in b&&B(a[f],b[f],c)))break}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor)return!1;for(var h in a)if(k.call(a,h)){f++;if(!(g=k.call(b,h)&&B(a[h],b[h],c)))break}if(g){for(h in b)if(k.call(b,h)&&!(f--))break;g=!f}}return c.pop(),g}var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.slice,h=d.concat,i=d.unshift,j=e.toString,k=e.hasOwnProperty,l=d.forEach,m=d.map,n=d.reduce,o=d.reduceRight,p=d.filter,q=d.every,r=d.some,s=d.indexOf,t=d.lastIndexOf,u=Array.isArray,v=Object.keys,w=f.bind,x=function(a){return new D(a)};x.VERSION="1.2.3";var y=x.each=x.forEach=function(a,b,d){if(a==null)return;if(l&&a.forEach===l)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(e in a&&b.call(d,a[e],e,a)===c)return}else for(var g in a)if(k.call(a,g)&&b.call(d,a[g],g,a)===c)return};x.map=function(a,b,c){var d=[];return a==null?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),d)},x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=x.toArray(a).reverse();return d&&!e&&(b=x.bind(b,d)),e?x.reduce(f,b,c,d):x.reduce(f,b)},x.find=x.detect=function(a,b,c){var d;return z(a,function(a,e,f){if(b.call(c,a,e,f))return d=a,!0}),d},x.filter=x.select=function(a,b,c){var d=[];return a==null?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},x.reject=function(a,b,c){var d=[];return a==null?d:(y(a,function(a,e,f){b.call(c,a,e,f)||(d[d.length]=a)}),d)},x.every=x.all=function(a,b,d){var e=!0;return a==null?e:q&&a.every===q?a.every(b,d):(y(a,function(a,f,g){if(!(e=e&&b.call(d,a,f,g)))return c}),e)};var z=x.some=x.any=function(a,b,d){b||(b=x.identity);var e=!1;return a==null?e:r&&a.some===r?a.some(b,d):(y(a,function(a,f,g){if(e||(e=b.call(d,a,f,g)))return c}),!!e)};x.include=x.contains=function(a,b){var c=!1;return a==null?c:s&&a.indexOf===s?a.indexOf(b)!=-1:(c=z(a,function(a){return a===b}),c)},x.invoke=function(a,b){var c=g.call(arguments,2);return x.map(a,function(a){return(b.call?b||a:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,function(a){return a[b]})},x.max=function(a,b,c){if(!b&&x.isArray(a))return Math.max.apply(Math,a);if(!b&&x.isEmpty(a))return-Infinity;var d={computed:-Infinity};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})}),d.value},x.min=function(a,b,c){if(!b&&x.isArray(a))return Math.min.apply(Math,a);if(!b&&x.isEmpty(a))return Infinity;var d={computed:Infinity};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},x.shuffle=function(a){var b=[],c;return y(a,function(a,d,e){d==0?b[0]=a:(c=Math.floor(Math.random()*(d+1)),b[d]=b[c],b[c]=a)}),b},x.sortBy=function(a,b,c){return x.pluck(x.map(a,function(a,d,e){return{value:a,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")},x.groupBy=function(a,b){var c={},d=x.isFunction(b)?b:function(a){return a[b]};return y(a,function(a,b){var e=d(a,b);(c[e]||(c[e]=[])).push(a)}),c},x.sortedIndex=function(a,b,c){c||(c=x.identity);var d=0,e=a.length;while(d<e){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d},x.toArray=function(a){return a?a.toArray?a.toArray():x.isArray(a)?g.call(a):x.isArguments(a)?g.call(a):x.values(a):[]},x.size=function(a){return x.toArray(a).length},x.first=x.head=function(a,b,c){return b!=null&&!c?g.call(a,0,b):a[0]},x.initial=function(a,b,c){return g.call(a,0,a.length-(b==null||c?1:b))},x.last=function(a,b,c){return b!=null&&!c?g.call(a,Math.max(a.length-b,0)):a[a.length-1]},x.rest=x.tail=function(a,b,c){return g.call(a,b==null||c?1:b)},x.compact=function(a){return x.filter(a,function(a){return!!a})},x.flatten=function(a,b){return x.reduce(a,function(a,c){return x.isArray(c)?a.concat(b?c:x.flatten(c)):(a[a.length]=c,a)},[])},x.without=function(a){return x.difference(a,g.call(arguments,1))},x.uniq=x.unique=function(a,b,c){var d=c?x.map(a,c):a,e=[];return x.reduce(d,function(c,d,f){if(0==f||(b===!0?x.last(c)!=d:!x.include(c,d)))c[c.length]=d,e[e.length]=a[f];return c},[]),e},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=x.intersect=function(a){var b=g.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.indexOf(b,a)>=0})})},x.difference=function(a){var b=x.flatten(g.call(arguments,1));return x.filter(a,function(a){return!x.include(b,a)})},x.zip=function(){var a=g.call(arguments),b=x.max(x.pluck(a,"length")),c=new Array(b);for(var d=0;d<b;d++)c[d]=x.pluck(a,""+d);return c},x.indexOf=function(a,b,c){if(a==null)return-1;var d,e;if(c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;if(s&&a.indexOf===s)return a.indexOf(b);for(d=0,e=a.length;d<e;d++)if(d in a&&a[d]===b)return d;return-1},x.lastIndexOf=function(a,b){if(a==null)return-1;if(t&&a.lastIndexOf===t)return a.lastIndexOf(b);var c=a.length;while(c--)if(c in a&&a[c]===b)return c;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);while(e<d)f[e++]=a,a+=c;return f};var A=function(){};x.bind=function(b,c){var d,e;if(b.bind===w&&w)return w.apply(b,g.call(arguments,1));if(!x.isFunction(b))throw new TypeError;return e=g.call(arguments,2),d=function(){if(this instanceof d){A.prototype=b.prototype;var a=new A,f=b.apply(a,e.concat(g.call(arguments)));return Object(f)===f?f:a}return b.apply(c,e.concat(g.call(arguments)))}},x.bindAll=function(a){var b=g.call(arguments,1);return b.length==0&&(b=x.functions(a)),y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return k.call(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=g.call(arguments,2);return setTimeout(function(){return a.apply(a,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(g.call(arguments,1)))},x.throttle=function(a,b){var c,d,e,f,g,h=x.debounce(function(){g=f=!1},b);return function(){c=this,d=arguments;var i=function(){e=null,g&&a.apply(c,d),h()};e||(e=setTimeout(i,b)),f?g=!0:a.apply(c,d),h(),f=!0}},x.debounce=function(a,b){var c;return function(){var d=this,e=arguments,f=function(){c=null,a.apply(d,e)};clearTimeout(c),c=setTimeout(f,b)}},x.once=function(a){var b=!1,c;return function(){return b?c:(b=!0,c=a.apply(this,arguments))}},x.wrap=function(a,b){return function(){var c=h.apply([a],arguments);return b.apply(this,c)}},x.compose=function(){var a=arguments;return function(){var b=arguments;for(var c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return a<=0?b():function(){if(--a<1)return b.apply(this,arguments)}},x.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)k.call(a,c)&&(b[b.length]=c);return b},x.values=function(a){return x.map(a,x.identity)},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(g.call(arguments,1),function(b){for(var c in b)b[c]!==void 0&&(a[c]=b[c])}),a},x.defaults=function(a){return y(g.call(arguments,1),function(b){for(var c in b)a[c]==null&&(a[c]=b[c])}),a},x.clone=function(a){return x.isObject(a)?x.isArray(a)?a.slice():x.extend({},a):a},x.tap=function(a,b){return b(a),a},x.isEqual=function(a,b){return B(a,b,[])},x.isEmpty=function(a){if(x.isArray(a)||x.isString(a))return a.length===0;for(var b in a)if(k.call(a,b))return!1;return!0},x.isElement=function(a){return!!a&&a.nodeType==1},x.isArray=u||function(a){return j.call(a)=="[object Array]"},x.isObject=function(a){return a===Object(a)},x.isArguments=function(a){return j.call(a)=="[object Arguments]"},x.isArguments(arguments)||(x.isArguments=function(a){return!!a&&!!k.call(a,"callee")}),x.isFunction=function(a){return j.call(a)=="[object Function]"},x.isString=function(a){return j.call(a)=="[object String]"},x.isNumber=function(a){return j.call(a)=="[object Number]"},x.isNaN=function(a){return a!==a},x.isBoolean=function(a){return a===!0||a===!1||j.call(a)=="[object Boolean]"},x.isDate=function(a){return j.call(a)=="[object Date]"},x.isRegExp=function(a){return j.call(a)=="[object RegExp]"},x.isNull=function(a){return a===null},x.isUndefined=function(a){return a===void 0},x.noConflict=function(){return a._=b,this},x.identity=function(a){return a},x.times=function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)},x.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},x.mixin=function(a){y(x.functions(a),function(b){F(b,x[b]=a[b])})};var C=0;x.uniqueId=function(a){var b=C++;return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},x.template=function(a,b){var c=x.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.escape,function(a,b){return"',_.escape("+b.replace(/\\'/g,"'")+"),'"}).replace(c.interpolate,function(a,b){return"',"+b.replace(/\\'/g,"'")+",'"}).replace(c.evaluate||null,function(a,b){return"');"+b.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj","_",d);if(b)return e(b,x);var f=function(a){return e.call(this,a,x)};return f.func=e,f};var D=function(a){this._wrapped=a};x.prototype=D.prototype;var E=function(a,b){return b?x(a).chain():a},F=function(a,b){D.prototype[a]=function(){var a=g.call(arguments);return i.call(a,this._wrapped),E(b.apply(x,a),this._chain)}};return x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];D.prototype[a]=function(){return b.apply(this._wrapped,arguments),E(this._wrapped,this._chain)}}),y(["concat","join","slice"],function(a){var b=d[a];D.prototype[a]=function(){return E(b.apply(this._wrapped,arguments),this._chain)}}),D.prototype.chain=function(){return this._chain=!0,this},D.prototype.value=function(){return this._wrapped},x}),define("joshfire-framework/vendor/backbone",["joshlib!vendor/underscore","joshlib!utils/dollar"],function(a,b){var c=this,d=c.Backbone,e;typeof exports!="undefined"?e=exports:e=c.Backbone={},e.VERSION="0.5.3",e.noConflict=function(){return c.Backbone=d,this},e.emulateHTTP=!1,e.emulateJSON=!1,e.Events={bind:function(a,b,c){var d=this._callbacks||(this._callbacks={}),e=d[a]||(d[a]=[]);return e.push([b,c]),this},unbind:function(a,b){var c;if(!a)this._callbacks={};else if(c=this._callbacks)if(!b)c[a]=[];else{var d=c[a];if(!d)return this;for(var e=0,f=d.length;e<f;e++)if(d[e]&&b===d[e][0]){d[e]=null;break}}return this},trigger:function(a){var b,c,d,e,f,g=2;if(!(c=this._callbacks))return this;while(g--){d=g?a:"all";if(b=c[d])for(var h=0,i=b.length;h<i;h++)(e=b[h])?(f=g?Array.prototype.slice.call(arguments,1):arguments,e[0].apply(e[1]||this,f)):(b.splice(h,1),h--,i--)}return this}},e.Model=function(b,c){var d;b||(b={});if(d=this.defaults)a.isFunction(d)&&(d=d.call(this)),b=a.extend({},d,b);this.attributes={},this._escapedAttributes={},this.cid=a.uniqueId("c"),this.set(b,{silent:!0}),this._changed=!1,this._previousAttributes=a.clone(this.attributes),c&&c.collection&&(this.collection=c.collection),this.initialize(b,c)},a.extend(e.Model.prototype,e.Events,{_previousAttributes:null,_changed:!1,idAttribute:"id",initialize:function(){},toJSON:function(){return a.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(a){var b;if(b=this._escapedAttributes[a])return b;var c=this.attributes[a];return this._escapedAttributes[a]=w(c==null?"":""+c)},has:function(a){return this.attributes[a]!=null},set:function(b,c){c||(c={});if(!b)return this;b.attributes&&(b=b.attributes);var d=this.attributes,e=this._escapedAttributes;if(!c.silent&&this.validate&&!this._performValidation(b,c))return!1;this.idAttribute in b&&(this.id=b[this.idAttribute]);var f=this._changing;this._changing=!0;for(var g in b){var h=b[g];a.isEqual(d[g],h)||(d[g]=h,delete e[g],this._changed=!0,c.silent||this.trigger("change:"+g,this,h,c))}return!f&&!c.silent&&this._changed&&this.change(c),this._changing=!1,this},unset:function(a,b){if(a in this.attributes){b||(b={});var c=this.attributes[a],d={};return d[a]=void 0,!b.silent&&this.validate&&!this._performValidation(d,b)?!1:(delete this.attributes[a],delete this._escapedAttributes[a],a==this.idAttribute&&delete this.id,this._changed=!0,b.silent||(this.trigger("change:"+a,this,void 0,b),this.change(b)),this)}return this},clear:function(a){a||(a={});var b,c=this.attributes,d={};for(b in c)d[b]=void 0;if(!a.silent&&this.validate&&!this._performValidation(d,a))return!1;this.attributes={},this._escapedAttributes={},this._changed=!0;if(!a.silent){for(b in c)this.trigger("change:"+b,this,void 0,a);this.change(a)}return this},fetch:function(a){a||(a={});var b=this,c=a.success;return a.success=function(d,e,f){if(!b.set(b.parse(d,f),a))return!1;c&&c(b,d)},a.error=v(a.error,b,a),(this.sync||e.sync).call(this,"read",this,a)},save:function(a,b){b||(b={});if(a&&!this.set(a,b))return!1;var c=this,d=b.success;b.success=function(a,e,f){if(!c.set(c.parse(a,f),b))return!1;d&&d(c,a,f)},b.error=v(b.error,c,b);var f=this.isNew()?"create":"update";return(this.sync||e.sync).call(this,f,this,b)},destroy:function(a){a||(a={});if(this.isNew())return this.trigger("destroy",this,this.collection,a);var b=this,c=a.success;return a.success=function(d){b.trigger("destroy",b,b.collection,a),c&&c(b,d)},a.error=v(a.error,b,a),(this.sync||e.sync).call(this,"delete",this,a)},url:function(){var a=t(this.collection)||this.urlRoot||u();return this.isNew()?a:a+(a.charAt(a.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(a,b){return a},clone:function(){return new this.constructor(this)},isNew:function(){return this.id==null},change:function(b){this.trigger("change",this,b),this._previousAttributes=a.clone(this.attributes),this._changed=!1},hasChanged:function(a){return a?this._previousAttributes[a]!=this.attributes[a]:this._changed},changedAttributes:function(b){b||(b=this.attributes);var c=this._previousAttributes,d=!1;for(var e in b)a.isEqual(c[e],b[e])||(d=d||{},d[e]=b[e]);return d},previous:function(a){return!a||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return a.clone(this._previousAttributes)},_performValidation:function(a,b){var c=this.validate(a);return c?(b.error?b.error(this,c,b):this.trigger("error",this,c,b),!1):!0}}),e.Collection=function(b,c){c||(c={}),c.comparator&&(this.comparator=c.comparator),a.bindAll(this,"_onModelEvent","_removeReference"),this._reset(),b&&this.reset(b,{silent:!0}),this.initialize.apply(this,arguments)},a.extend(e.Collection.prototype,e.Events,{model:e.Model,initialize:function(){},toJSON:function(){return this.map(function(a){return a.toJSON()})},add:function(b,c){if(a.isArray(b))for(var d=0,e=b.length;d<e;d++)this._add(b[d],c);else this._add(b,c);return this},remove:function(b,c){if(a.isArray(b))for(var d=0,e=b.length;d<e;d++)this._remove(b[d],c);else this._remove(b,c);return this},get:function(a){return a==null?null:this._byId[a.id!=null?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},sort:function(a){a||(a={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return this.models=this.sortBy(this.comparator),a.silent||this.trigger("reset",this,a),this},pluck:function(b){return a.map(this.models,function(a){return a.get(b)})},reset:function(a,b){return a||(a=[]),b||(b={}),this.each(this._removeReference),this._reset(),this.add(a,{silent:!0}),b.silent||this.trigger("reset",this,b),this},fetch:function(a){a||(a={});var b=this,c=a.success;return a.success=function(d,e,f){b[a.add?"add":"reset"](b.parse(d,f),a),c&&c(b,d)},a.error=v(a.error,b,a),(this.sync||e.sync).call(this,"read",this,a)},create:function(a,b){var c=this;b||(b={}),a=this._prepareModel(a,b);if(!a)return!1;var d=b.success;return b.success=function(a,e,f){c.add(a,b),d&&d(a,e,f)},a.save(null,b),a},parse:function(a,b){return a},chain:function(){return a(this.models).chain()},_reset:function(a){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(a,b){if(a instanceof e.Model)a.collection||(a.collection=this);else{var c=a;a=new this.model(c,{collection:this}),a.validate&&!a._performValidation(c,b)&&(a=!1)}return a},_add:function(a,b){b||(b={}),a=this._prepareModel(a,b);if(!a)return!1;var c=this.getByCid(a);if(c)throw new Error(["Can't add the same model to a set twice",c.id]);this._byId[a.id]=a,this._byCid[a.cid]=a;var d=b.at!=null?b.at:this.comparator?this.sortedIndex(a,this.comparator):this.length;return this.models.splice(d,0,a),a.bind("all",this._onModelEvent),this.length++,b.silent||a.trigger("add",a,this,b),a},_remove:function(a,b){return b||(b={}),a=this.getByCid(a)||this.get(a),a?(delete this._byId[a.id],delete this._byCid[a.cid],this.models.splice(this.indexOf(a),1),this.length--,b.silent||a.trigger("remove",a,this,b),this._removeReference(a),a):null},_removeReference:function(a){this==a.collection&&delete a.collection,a.unbind("all",this._onModelEvent)},_onModelEvent:function(a,b,c,d){if(a!="add"&&a!="remove"||c==this)a=="destroy"&&this._remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],this._byId[b.id]=b),this.trigger.apply(this,arguments);else return}});var f=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","rest","last","without","indexOf","lastIndexOf","isEmpty","groupBy"];a.each(f,function(b){e.Collection.prototype[b]=function(){return a[b].apply(a,[this.models].concat(a.toArray(arguments)))}}),e.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)};var g=/:([\w\d]+)/g,h=/\*([\w\d]+)/g,i=/[-[\]{}()+?.,\\^$|#\s]/g;a.extend(e.Router.prototype,e.Events,{initialize:function(){},route:function(b,c,d){e.history||(e.history=new e.History),a.isRegExp(b)||(b=this._routeToRegExp(b)),e.history.route(b,a.bind(function(a){var e=this._extractParameters(b,a);d.apply(this,e),this.trigger.apply(this,["route:"+c].concat(e))},this))},navigate:function(a,b){e.history.navigate(a,b)},_bindRoutes:function(){if(!this.routes)return;var a=[];for(var b in this.routes)a.unshift([b,this.routes[b]]);for(var c=0,d=a.length;c<d;c++)this.route(a[c][0],a[c][1],this[a[c][1]])},_routeToRegExp:function(a){return a=a.replace(i,"\\$&").replace(g,"([^/]*)").replace(h,"(.*?)"),new RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}}),e.History=function(){this.handlers=[],a.bindAll(this,"checkUrl")};var j=/^#*/,k=/msie [\w.]+/,l=!1;a.extend(e.History.prototype,{interval:50,getFragment:function(a,b){if(a==null)if(this._hasPushState||b){a=window.location.pathname;var c=window.location.search;c&&(a+=c),a.indexOf(this.options.root)==0&&(a=a.substr(this.options.root.length))}else a=window.location.hash;return decodeURIComponent(a.replace(j,""))},start:function(c){if(l)throw new Error("Backbone.history has already been started");this.options=a.extend({},{root:"/"},this.options,c),this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var d=this.getFragment(),e=document.documentMode,f=k.exec(navigator.userAgent.toLowerCase())&&(!e||e<=7);f&&(this.iframe=b('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(d)),this._hasPushState?b(window).bind("popstate",this.checkUrl):"onhashchange"in window&&!f?b(window).bind("hashchange",this.checkUrl):setInterval(this.checkUrl,this.interval),this.fragment=d,l=!0;var g=window.location,h=g.pathname==this.options.root;if(this._wantsPushState&&!this._hasPushState&&!h)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&h&&g.hash&&(this.fragment=g.hash.replace(j,""),window.history.replaceState({},document.title,g.protocol+"//"+g.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(a){var b=this.getFragment();b==this.fragment&&this.iframe&&(b=this.getFragment(this.iframe.location.hash));if(b==this.fragment||b==decodeURIComponent(this.fragment))return!1;this.iframe&&this.navigate(b),this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(b){var c=this.fragment=this.getFragment(b),d=a.any(this.handlers,function(a){if(a.route.test(c))return a.callback(c),!0});return d},navigate:function(a,b){var c=(a||"").replace(j,"");if(this.fragment==c||this.fragment==decodeURIComponent(c))return;if(this._hasPushState){var d=window.location;c.indexOf(this.options.root)!=0&&(c=this.options.root+c),this.fragment=c,window.history.pushState({},document.title,d.protocol+"//"+d.host+c)}else window.location.hash=this.fragment=c,this.iframe&&c!=this.getFragment(this.iframe.location.hash)&&(this.iframe.document.open().close(),this.iframe.location.hash=c);b&&this.loadUrl(a)}}),e.View=function(b){this.cid=a.uniqueId("view"),this._configure(b||{}),this._ensureElement(),this.delegateEvents(),this.initialize.apply(this,arguments)};var m=function(a){return b(a,this.el)},n=/^(\S+)\s*(.*)$/,o=["model","collection","el","id","attributes","className","tagName"];a.extend(e.View.prototype,e.Events,{tagName:"div",$:m,initialize:function(){},render:function(){return this},remove:function(){return b(this.el).remove(),this},make:function(a,c,d){var e=document.createElement(a);return c&&b(e).attr(c),d&&b(e).html(d),e},delegateEvents:function(c){if(!c&&!(c=this.events))return;a.isFunction(c)&&(c=c.call(this)),b(this.el).unbind(".delegateEvents"+this.cid);for(var d in c){var e=this[c[d]];if(!e)throw new Error('Event "'+c[d]+'" does not exist');var f=d.match(n),g=f[1],h=f[2];e=a.bind(e,this),g+=".delegateEvents"+this.cid,h===""?b(this.el).bind(g,e):b(this.el).delegate(h,g,e)}},_configure:function(b){this.options&&(b=a.extend({},this.options,b));for(var c=0,d=o.length;c<d;c++){var e=o[c];b[e]&&(this[e]=b[e])}this.options=b},_ensureElement:function(){if(!this.el){var c=this.attributes||{};this.id&&(c.id=this.id),this.className&&(c["class"]=this.className),this.el=this.make(this.tagName,c)}else a.isString(this.el)&&(this.el=b(this.el).get(0))}});var p=function(a,b){var c=s(this,a,b);return c.extend=this.extend,c};e.Model.extend=e.Collection.extend=e.Router.extend=e.View.extend=p;var q={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};e.sync=function(c,d,f){var g=q[c],h=a.extend({type:g,dataType:"json"},f);return h.url||(h.url=t(d)||u()),!h.data&&d&&(c=="create"||c=="update")&&(h.contentType="application/json",h.data=JSON.stringify(d.toJSON())),e.emulateJSON&&(h.contentType="application/x-www-form-urlencoded",h.data=h.data?{model:h.data}:{}),e.emulateHTTP&&(g==="PUT"||g==="DELETE")&&(e.emulateJSON&&(h.data._method=g),h.type="POST",h.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",g)}),h.type!=="GET"&&!e.emulateJSON&&(h.processData=!1),b.ajax(h)};var r=function(){},s=function(b,c,d){var e;return c&&c.hasOwnProperty("constructor")?e=c.constructor:e=function(){return b.apply(this,arguments)},a.extend(e,b),r.prototype=b.prototype,e.prototype=new r,c&&a.extend(e.prototype,c),d&&a.extend(e,d),e.prototype.constructor=e,e.__super__=b.prototype,e},t=function(b){return!b||!b.url?null:a.isFunction(b.url)?b.url():b.url},u=function(){throw new Error('A "url" property or function must be specified')},v=function(a,b,c){return function(d){a?a(b,d,c):b.trigger("error",b,d,c)}},w=function(a){return a.replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};return e}),define("joshfire-framework/router",["joshlib!vendor/backbone","joshlib!vendor/underscore"],function(a,b){var c=function(c){b.extend(c,{historyStart:function(b){a.history.start(b)}});var d=a.Router.extend(c);return new d};return c}),define("joshfire-framework/vendor/iscroll",[],function(){return function(){var a=Math,b=function(a){return a>>0},c=/webkit/i.test(navigator.appVersion)?"webkit":/firefox/i.test(navigator.userAgent)?"Moz":"opera"in window?"O":"",d=/android/gi.test(navigator.appVersion),e=/iphone|ipad/gi.test(navigator.appVersion),f=/playbook/gi.test(navigator.appVersion),g=/hp-tablet/gi.test(navigator.appVersion),h="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,i="ontouchstart"in window&&!g,j=c+"Transform"in document.documentElement.style,k=e||f,l=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return setTimeout(a,1)}}(),m=function(){return window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout}(),n="resize",o=i?"touchstart":"mousedown",p=i?"touchmove":"mousemove",q=i?"touchend":"mouseup",r=i?"touchcancel":"mouseup",s=c=="Moz"?"DOMMouseScroll":"mousewheel",t="translate"+(h?"3d(":"("),u=h?",0)":")",v=function(a,b){var f=this,g=document,l;f.wrapper=typeof a=="object"?a:g.getElementById(a),f.wrapper.style.overflow="hidden",f.scroller=f.wrapper.children[0],f.options={hScroll:!0,vScroll:!0,x:0,y:0,bounce:!0,bounceLock:!1,momentum:!0,lockDirection:!0,useTransform:!0,useTransition:!1,topOffset:0,checkDOMChanges:!1,hScrollbar:!0,vScrollbar:!0,fixedScrollbar:d,hideScrollbar:e,fadeScrollbar:e&&h,scrollbarClass:"",zoom:!1,zoomMin:1,zoomMax:4,doubleTapZoom:2,wheelAction:"scroll",snap:!1,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(a){a.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null};for(l in b)f.options[l]=b[l];f.x=f.options.x,f.y=f.options.y,f.options.useTransform=j?f.options.useTransform:!1,f.options.hScrollbar=f.options.hScroll&&f.options.hScrollbar,f.options.vScrollbar=f.options.vScroll&&f.options.vScrollbar,f.options.zoom=f.options.useTransform&&f.options.zoom,f.options.useTransition=k&&f.options.useTransition,f.options.zoom&&d&&(t="translate(",u=")"),f.scroller.style[c+"TransitionProperty"]=f.options.useTransform?"-"+c.toLowerCase()+"-transform":"top left",f.scroller.style[c+"TransitionDuration"]="0",f.scroller.style[c+"TransformOrigin"]="0 0",f.options.useTransition&&(f.scroller.style[c+"TransitionTimingFunction"]="cubic-bezier(0.33,0.66,0.66,1)"),f.options.useTransform?f.scroller.style[c+"Transform"]=t+f.x+"px,"+f.y+"px"+u:f.scroller.style.cssText+=";position:absolute;top:"+f.y+"px;left:"+f.x+"px",f.options.useTransition&&(f.options.fixedScrollbar=!0),f.refresh(),f._bind(n,window),f._bind(o),i||(f._bind("mouseout",f.wrapper),f.options.wheelAction!="none"&&f._bind(s)),f.options.checkDOMChanges&&(f.checkDOMTime=setInterval(function(){f._checkDOMChanges()},500))};v.prototype={enabled:!0,x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(a){var b=this;switch(a.type){case o:if(!i&&a.button!==0)return;b._start(a);break;case p:b._move(a);break;case q:case r:b._end(a);break;case n:b._resize();break;case s:b._wheel(a);break;case"mouseout":b._mouseout(a);break;case"webkitTransitionEnd":b._transitionEnd(a)}},_checkDOMChanges:function(){if(this.moved||this.zoomed||this.animating||this.scrollerW==this.scroller.offsetWidth*this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale)return;this.refresh()},_scrollbar:function(d){var e=this,f=document,g;if(!e[d+"Scrollbar"]){e[d+"ScrollbarWrapper"]&&(j&&(e[d+"ScrollbarIndicator"].style[c+"Transform"]=""),e[d+"ScrollbarWrapper"].parentNode&&e[d+"ScrollbarWrapper"].parentNode.removeChild(e[d+"ScrollbarWrapper"]),e[d+"ScrollbarWrapper"]=null,e[d+"ScrollbarIndicator"]=null);return}e[d+"ScrollbarWrapper"]||(g=f.createElement("div"),e.options.scrollbarClass?g.className=e.options.scrollbarClass+d.toUpperCase():g.style.cssText="position:absolute;z-index:100;"+(d=="h"?"height:7px;bottom:1px;left:2px;right:"+(e.vScrollbar?"7":"2")+"px":"width:7px;bottom:"+(e.hScrollbar?"7":"2")+"px;top:2px;right:1px"),g.style.cssText+=";pointer-events:none;-"+c+"-transition-property:opacity;-"+c+"-transition-duration:"+(e.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(e.options.hideScrollbar?"0":"1"),e.wrapper.appendChild(g),e[d+"ScrollbarWrapper"]=g,g=f.createElement("div"),e.options.scrollbarClass||(g.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);-"+c+"-background-clip:padding-box;-"+c+"-box-sizing:border-box;"+(d=="h"?"height:100%":"width:100%")+";-"+c+"-border-radius:3px;border-radius:3px"),g.style.cssText+=";pointer-events:none;-"+c+"-transition-property:-"+c+"-transform;-"+c+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);-"+c+"-transition-duration:0;-"+c+"-transform:"+t+"0,0"+u,e.options.useTransition&&(g.style.cssText+=";-"+c+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)"),e[d+"ScrollbarWrapper"].appendChild(g),e[d+"ScrollbarIndicator"]=g),d=="h"?(e.hScrollbarSize=e.hScrollbarWrapper.clientWidth,e.hScrollbarIndicatorSize=a.max(b(e.hScrollbarSize*e.hScrollbarSize/e.scrollerW),8),e.hScrollbarIndicator.style.width=e.hScrollbarIndicatorSize+"px",e.hScrollbarMaxScroll=e.hScrollbarSize-e.hScrollbarIndicatorSize,e.hScrollbarProp=e.hScrollbarMaxScroll/e.maxScrollX):(e.vScrollbarSize=e.vScrollbarWrapper.clientHeight,e.vScrollbarIndicatorSize=a.max(b(e.vScrollbarSize*e.vScrollbarSize/e.scrollerH),8),e.vScrollbarIndicator.style.height=e.vScrollbarIndicatorSize+"px",e.vScrollbarMaxScroll=e.vScrollbarSize-e.vScrollbarIndicatorSize,e.vScrollbarProp=e.vScrollbarMaxScroll/e.maxScrollY),e._scrollbarPos(d,!0)},_resize:function(){var a=this;setTimeout(function(){a.refresh()},d?200:0)},_pos:function(a,d){a=this.hScroll?a:0,d=this.vScroll?d:0,this.options.useTransform?this.scroller.style[c+"Transform"]=t+a+"px,"+d+"px"+u+" scale("+this.scale+")":(a=b(a),d=b(d),this.scroller.style.left=a+"px",this.scroller.style.top=d+"px"),this.x=a,this.y=d,this._scrollbarPos("h"),this._scrollbarPos("v")},_scrollbarPos:function(a,d){var e=this,f=a=="h"?e.x:e.y,g;if(!e[a+"Scrollbar"])return;f=e[a+"ScrollbarProp"]*f,f<0?(e.options.fixedScrollbar||(g=e[a+"ScrollbarIndicatorSize"]+b(f*3),g<8&&(g=8),e[a+"ScrollbarIndicator"].style[a=="h"?"width":"height"]=g+"px"),f=0):f>e[a+"ScrollbarMaxScroll"]&&(e.options.fixedScrollbar?f=e[a+"ScrollbarMaxScroll"]:(g=e[a+"ScrollbarIndicatorSize"]-b((f-e[a+"ScrollbarMaxScroll"])*3),g<8&&(g=8),e[a+"ScrollbarIndicator"].style[a=="h"?"width":"height"]=g+"px",f=e[a+"ScrollbarMaxScroll"]+(e[a+"ScrollbarIndicatorSize"]-g))),e[a+"ScrollbarWrapper"].style[c+"TransitionDelay"]="0",e[a+"ScrollbarWrapper"].style.opacity=d&&e.options.hideScrollbar?"0":"1",e[a+"ScrollbarIndicator"].style[c+"Transform"]=t+(a=="h"?f+"px,0":"0,"+f+"px")+u},_start:function(b){var d=this,e=i?b.touches[0]:b,f,g,h,j,k;if(!d.enabled)return;d.options.onBeforeScrollStart&&d.options.onBeforeScrollStart.call(d,b),(d.options.useTransition||d.options.zoom)&&d._transitionTime(0),d.moved=!1,d.animating=!1,d.zoomed=!1,d.distX=0,d.distY=0,d.absDistX=0,d.absDistY=0,d.dirX=0,d.dirY=0,d.options.zoom&&i&&b.touches.length>1&&(j=a.abs(b.touches[0].pageX-b.touches[1].pageX),k=a.abs(b.touches[0].pageY-b.touches[1].pageY),d.touchesDistStart=a.sqrt(j*j+k*k),d.originX=a.abs(b.touches[0].pageX+b.touches[1].pageX-d.wrapperOffsetLeft*2)/2-d.x,d.originY=a.abs(b.touches[0].pageY+b.touches[1].pageY-d.wrapperOffsetTop*2)/2-d.y,d.options.onZoomStart&&d.options.onZoomStart.call(d,b));if(d.options.momentum){d.options.useTransform?(f=getComputedStyle(d.scroller,null)[c+"Transform"].replace(/[^0-9-.,]/g,"").split(","),g=f[4]*1,h=f[5]*1):(g=getComputedStyle(d.scroller,null).left.replace(/[^0-9-]/g,"")*1,h=getComputedStyle(d.scroller,null).top.replace(/[^0-9-]/g,"")*1);if(g!=d.x||h!=d.y)d.options.useTransition?d._unbind("webkitTransitionEnd"):m(d.aniTime),d.steps=[],d._pos(g,h)}d.absStartX=d.x,d.absStartY=d.y,d.startX=d.x,d.startY=d.y,d.pointX=e.pageX,d.pointY=e.pageY,d.startTime=b.timeStamp||Date.now(),d.options.onScrollStart&&d.options.onScrollStart.call(d,b),d._bind(p),d._bind(q),d._bind(r)},_move:function(b){var d=this,e=i?b.touches[0]:b,f=e.pageX-d.pointX,g=e.pageY-d.pointY,h=d.x+f,j=d.y+g,k,l,m,n=b.timeStamp||Date.now();d.options.onBeforeScrollMove&&d.options.onBeforeScrollMove.call(d,b);if(d.options.zoom&&i&&b.touches.length>1){k=a.abs(b.touches[0].pageX-b.touches[1].pageX),l=a.abs(b.touches[0].pageY-b.touches[1].pageY),d.touchesDist=a.sqrt(k*k+l*l),d.zoomed=!0,m=1/d.touchesDistStart*d.touchesDist*this.scale,m<d.options.zoomMin?m=.5*d.options.zoomMin*Math.pow(2,m/d.options.zoomMin):m>d.options.zoomMax&&(m=2*d.options.zoomMax*Math.pow(.5,d.options.zoomMax/m)),d.lastScale=m/this.scale,h=this.originX-this.originX*d.lastScale+this.x,j=this.originY-this.originY*d.lastScale+this.y,this.scroller.style[c+"Transform"]=t+h+"px,"+j+"px"+u+" scale("+m+")",d.options.onZoom&&d.options.onZoom.call(d,b);return}d.pointX=e.pageX,d.pointY=e.pageY;if(h>0||h<d.maxScrollX)h=d.options.bounce?d.x+f/2:h>=0||d.maxScrollX>=0?0:d.maxScrollX;if(j>d.minScrollY||j<d.maxScrollY)j=d.options.bounce?d.y+g/2:j>=d.minScrollY||d.maxScrollY>=0?d.minScrollY:d.maxScrollY;if(d.absDistX<6&&d.absDistY<6){d.distX+=f,d.distY+=g,d.absDistX=a.abs(d.distX),d.absDistY=a.abs(d.distY);return}d.options.lockDirection&&(d.absDistX>d.absDistY+5?(j=d.y,g=0):d.absDistY>d.absDistX+5&&(h=d.x,f=0)),d.moved=!0,d._pos(h,j),d.dirX=f>0?-1:f<0?1:0,d.dirY=g>0?-1:g<0?1:0,n-d.startTime>300&&(d.startTime=n,d.startX=d.x,d.startY=d.y),d.options.onScrollMove&&d.options.onScrollMove.call(d,b)},_end:function(d){if(i&&d.touches.length!=0)return;var e=this,f=i?d.changedTouches[0]:d,g,h,j={dist:0,time:0},k={dist:0,time:0},l=(d.timeStamp||Date.now())-e.startTime,m=e.x,n=e.y,o,s,v,w,x;e._unbind(p),e._unbind(q),e._unbind(r),e.options.onBeforeScrollEnd&&e.options.onBeforeScrollEnd.call(e,d);if(e.zoomed){x=e.scale*e.lastScale,x=Math.max(e.options.zoomMin,x),x=Math.min(e.options.zoomMax,x),e.lastScale=x/e.scale,e.scale=x,e.x=e.originX-e.originX*e.lastScale+e.x,e.y=e.originY-e.originY*e.lastScale+e.y,e.scroller.style[c+"TransitionDuration"]="200ms",e.scroller.style[c+"Transform"]=t+e.x+"px,"+e.y+"px"+u+" scale("+e.scale+")",e.zoomed=!1,e.refresh(),e.options.onZoomEnd&&e.options.onZoomEnd.call(e,d);return}if(!e.moved){i&&(e.doubleTapTimer&&e.options.zoom?(clearTimeout(e.doubleTapTimer),e.doubleTapTimer=null,e.options.onZoomStart&&e.options.onZoomStart.call(e,d),e.zoom(e.pointX,e.pointY,e.scale==1?e.options.doubleTapZoom:1),e.options.onZoomEnd&&setTimeout(function(){e.options.onZoomEnd.call(e,d)},200)):e.doubleTapTimer=setTimeout(function(){e.doubleTapTimer=null,g=f.target;while(g.nodeType!=1)g=g.parentNode;g.tagName!="SELECT"&&g.tagName!="INPUT"&&g.tagName!="TEXTAREA"&&(h=document.createEvent("MouseEvents"),h.initMouseEvent("click",!0,!0,d.view,1,f.screenX,f.screenY,f.clientX,f.clientY,d.ctrlKey,d.altKey,d.shiftKey,d.metaKey,0,null),h._fake=!0,g.dispatchEvent(h))},e.options.zoom?250:0)),e._resetPos(200),e.options.onTouchEnd&&e.options.onTouchEnd.call(e,d,!1);return}if(l<300&&e.options.momentum){j=m?e._momentum(m-e.startX,l,-e.x,e.scrollerW-e.wrapperW+e.x,e.options.bounce?e.wrapperW:0):j,k=n?e._momentum(n-e.startY,l,-e.y,e.maxScrollY<0?e.scrollerH-e.wrapperH+e.y-e.minScrollY:0,e.options.bounce?e.wrapperH:0):k,m=e.x+j.dist,n=e.y+k.dist;if(e.x>0&&m>0||e.x<e.maxScrollX&&m<e.maxScrollX)j={dist:0,time:0};if(e.y>e.minScrollY&&n>e.minScrollY||e.y<e.maxScrollY&&n<e.maxScrollY)k={dist:0,time:0}}if(j.dist||k.dist){v=a.max(a.max(j.time,k.time),10),e.options.snap&&(o=m-e.absStartX,s=n-e.absStartY,a.abs(o)<e.options.snapThreshold&&a.abs(s)<e.options.snapThreshold?e.scrollTo(e.absStartX,e.absStartY,200):(w=e._snap(m,n),m=w.x,n=w.y,v=a.max(w.time,v))),e.scrollTo(b(m),b(n),v),e.options.onTouchEnd&&e.options.onTouchEnd.call(e,d,!0);return}if(e.options.snap){o=m-e.absStartX,s=n-e.absStartY,a.abs(o)<e.options.snapThreshold&&a.abs(s)<e.options.snapThreshold?e.scrollTo(e.absStartX,e.absStartY,200):(w=e._snap(e.x,e.y),(w.x!=e.x||w.y!=e.y)&&e.scrollTo(w.x,w.y,w.time)),e.options.onTouchEnd&&e.options.onTouchEnd.call(e,d,!0);return}e._resetPos(200),e.options.onTouchEnd&&e.options.onTouchEnd.call(e,d,!0)},_resetPos:function(a){var b=this,d=b.x>=0?0:b.x<b.maxScrollX?b.maxScrollX:b.x,e=b.y>=b.minScrollY||b.maxScrollY>0?b.minScrollY:b.y<b.maxScrollY?b.maxScrollY:b.y;if(d==b.x&&e==b.y){b.moved=!1,b.options.onScrollEnd&&b.options.onScrollEnd.call(b),b.hScrollbar&&b.options.hideScrollbar&&(c=="webkit"&&(b.hScrollbarWrapper.style[c+"TransitionDelay"]="300ms"),b.hScrollbarWrapper.style.opacity="0"),b.vScrollbar&&b.options.hideScrollbar&&(c=="webkit"&&(b.vScrollbarWrapper.style[c+"TransitionDelay"]="300ms"),b.vScrollbarWrapper.style.opacity="0");return}b.scrollTo(d,e,a||0)},_wheel:function(a){var b=this,c,d,e,f,g;"wheelDeltaX"in a?(c=a.wheelDeltaX/12,d=a.wheelDeltaY/12):"detail"in a?c=d=-a.detail*3:c=d=-a.wheelDelta;if(b.options.wheelAction=="zoom"){g=b.scale*Math.pow(2,1/3*(d?d/Math.abs(d):0)),g<b.options.zoomMin&&(g=b.options.zoomMin),g>b.options.zoomMax&&(g=b.options.zoomMax),g!=b.scale&&(!b.wheelZoomCount&&b.options.onZoomStart&&b.options.onZoomStart.call(b,a),b.wheelZoomCount++,b.zoom(a.pageX,a.pageY,g,400),setTimeout(function(){b.wheelZoomCount--,!b.wheelZoomCount&&b.options.onZoomEnd&&b.options.onZoomEnd.call(b,a)},400));return}e=b.x+c,f=b.y+d,e>0?e=0:e<b.maxScrollX&&(e=b.maxScrollX),f>b.minScrollY?f=b.minScrollY:f<b.maxScrollY&&(f=b.maxScrollY),b.scrollTo(e,f,0)},_mouseout:function(a){var b=a.relatedTarget;if(!b){this._end(a);return}while(b=b.parentNode)if(b==this.wrapper)return;this._end(a)},_transitionEnd:function(a){var b=this;if(a.target!=b.scroller)return;b._unbind("webkitTransitionEnd"),b._startAni()},_startAni:function(){var b=this,c=b.x,d=b.y,e=Date.now(),f,g,h;if(b.animating)return;if(!b.steps.length){b._resetPos(400);return}f=b.steps.shift(),f.x==c&&f.y==d&&(f.time=0),b.animating=!0,b.moved=!0;if(b.options.useTransition){b._transitionTime(f.time),b._pos(f.x,f.y),b.animating=!1,f.time?b._bind("webkitTransitionEnd"):b._resetPos(0);return}h=function(){var i=Date.now(),j,k;if(i>=e+f.time){b._pos(f.x,f.y),b.animating=!1,b.options.onAnimationEnd&&b.options.onAnimationEnd.call(b),b._startAni();return}i=(i-e)/f.time-1,g=a.sqrt(1-i*i),j=(f.x-c)*g+c,k=(f.y-d)*g+d,b._pos(j,k),b.animating&&(b.aniTime=l(h))},h()},_transitionTime:function(a){a+="ms",this.scroller.style[c+"TransitionDuration"]=a,this.hScrollbar&&(this.hScrollbarIndicator.style[c+"TransitionDuration"]=a),this.vScrollbar&&(this.vScrollbarIndicator.style[c+"TransitionDuration"]=a)},_momentum:function(c,d,e,f,g){var h=6e-4,i=a.abs(c)/d,j=i*i/(2*h),k=0,l=0;return c>0&&j>e?(l=g/(6/(j/i*h)),e+=l,i=i*e/j,j=e):c<0&&j>f&&(l=g/(6/(j/i*h)),f+=l,i=i*f/j,j=f),j*=c<0?-1:1,k=i/h,{dist:j,time:b(k)}},_offset:function(a){var b=-a.offsetLeft,c=-a.offsetTop;while(a=a.offsetParent)b-=a.offsetLeft,c-=a.offsetTop;return a!=this.wrapper&&(b*=this.scale,c*=this.scale),{left:b,top:c}},_snap:function(c,d){var e=this,f,g,h,i,j,k;h=e.pagesX.length-1;for(f=0,g=e.pagesX.length;f<g;f++)if(c>=e.pagesX[f]){h=f;break}h==e.currPageX&&h>0&&e.dirX<0&&h--,c=e.pagesX[h],j=a.abs(c-e.pagesX[e.currPageX]),j=j?a.abs(e.x-c)/j*500:0,e.currPageX=h,h=e.pagesY.length-1;for(f=0;f<h;f++)if(d>=e.pagesY[f]){h=f;break}return h==e.currPageY&&h>0&&e.dirY<0&&h--,d=e.pagesY[h],k=a.abs(d-e.pagesY[e.currPageY]),k=k?a.abs(e.y-d)/k*500:0,e.currPageY=h,i=b(a.max(j,k))||200,{x:c,y:d,time:i}},_bind:function(a,b,c){(b||this.scroller).addEventListener(a,this,!!c)},_unbind:function(a,b,c){(b||this.scroller).removeEventListener(a,this,!!c)},destroy:function(){var a=this;a.scroller.style[c+"Transform"]="",a.hScrollbar=!1,a.vScrollbar=!1,a._scrollbar("h"),a._scrollbar("v"),a._unbind(n,window),a._unbind(o),a._unbind(p),a._unbind(q),a._unbind(r),a.options.hasTouch||(a._unbind("mouseout",a.wrapper),a._unbind(s)),a.options.useTransition&&a._unbind("webkitTransitionEnd"),a.options.checkDOMChanges&&clearInterval(a.checkDOMTime),a.options.onDestroy&&a.options.onDestroy.call(a)},refresh:function(){var a=this,d,e,f,g,h=0,i=0;a.scale<a.options.zoomMin&&(a.scale=a.options.zoomMin),a.wrapperW=a.wrapper.clientWidth||1,a.wrapperH=a.wrapper.clientHeight||1,a.minScrollY=-a.options.topOffset||0,a.scrollerW=b(a.scroller.offsetWidth*a.scale),a.scrollerH=b((a.scroller.offsetHeight+a.minScrollY)*a.scale),a.maxScrollX=a.wrapperW-a.scrollerW,a.maxScrollY=a.wrapperH-a.scrollerH+a.minScrollY,a.dirX=0,a.dirY=0,a.options.onRefresh&&a.options.onRefresh.call(a),a.hScroll=a.options.hScroll&&a.maxScrollX<0,a.vScroll=a.options.vScroll&&(!a.options.bounceLock&&!a.hScroll||a.scrollerH>a.wrapperH),a.hScrollbar=a.hScroll&&a.options.hScrollbar,a.vScrollbar=a.vScroll&&a.options.vScrollbar&&a.scrollerH>a.wrapperH,d=a._offset(a.wrapper),a.wrapperOffsetLeft=-d.left,a.wrapperOffsetTop=-d.top;if(typeof a.options.snap=="string"){a.pagesX=[],a.pagesY=[],g=a.scroller.querySelectorAll(a.options.snap);for(e=0,f=g.length;e<f;e++)h=a._offset(g[e]),h.left+=a.wrapperOffsetLeft,h.top+=a.wrapperOffsetTop,a.pagesX[e]=h.left<a.maxScrollX?a.maxScrollX:h.left*a.scale,a.pagesY[e]=h.top<a.maxScrollY?a.maxScrollY:h.top*a.scale}else if(a.options.snap){a.pagesX=[];while(h>=a.maxScrollX)a.pagesX[i]=h,h-=a.wrapperW,i++;a.maxScrollX%a.wrapperW&&(a.pagesX[a.pagesX.length]=a.maxScrollX-a.pagesX[a.pagesX.length-1]+a.pagesX[a.pagesX.length-1]),h=0,i=0,a.pagesY=[];while(h>=a.maxScrollY)a.pagesY[i]=h,h-=a.wrapperH,i++;a.maxScrollY%a.wrapperH&&(a.pagesY[a.pagesY.length]=a.maxScrollY-a.pagesY[a.pagesY.length-1]+a.pagesY[a.pagesY.length-1])}a._scrollbar("h"),a._scrollbar("v"),a.zoomed||(a.scroller.style[c+"TransitionDuration"]="0",a._resetPos(200))},scrollTo:function(a,b,c,d){var e=this,f=a,g,h;e.stop(),f.length||(f=[{x:a,y:b,time:c,relative:d}]);for(g=0,h=f.length;g<h;g++)f[g].relative&&(f[g].x=e.x-f[g].x,f[g].y=e.y-f[g].y),e.steps.push({x:f[g].x,y:f[g].y,time:f[g].time||0});e._startAni()},scrollToElement:function(b,c){var d=this,e;b=b.nodeType?b:d.scroller.querySelector(b);if(!b)return;e=d._offset(b),e.left+=d.wrapperOffsetLeft,e.top+=d.wrapperOffsetTop,e.left=e.left>0?0:e.left<d.maxScrollX?d.maxScrollX:e.left,e.top=e.top>d.minScrollY?d.minScrollY:e.top<d.maxScrollY?d.maxScrollY:e.top,c=c===undefined?a.max(a.abs(e.left)*2,a.abs(e.top)*2):c,d.scrollTo(e.left,e.top,c)},scrollToPage:function(a,b,c){var d=this,e,f;c=c===undefined?400:c,d.options.onScrollStart&&d.options.onScrollStart.call(d),d.options.snap?(a=a=="next"?d.currPageX+1:a=="prev"?d.currPageX-1:a,b=b=="next"?d.currPageY+1:b=="prev"?d.currPageY-1:b,a=a<0?0:a>d.pagesX.length-1?d.pagesX.length-1:a,b=b<0?0:b>d.pagesY.length-1?d.pagesY.length-1:b,d.currPageX=a,d.currPageY=b,e=d.pagesX[a],f=d.pagesY[b]):(e=-d.wrapperW*a,f=-d.wrapperH*b,e<d.maxScrollX&&(e=d.maxScrollX),f<d.maxScrollY&&(f=d.maxScrollY)),d.scrollTo(e,f,c)},disable:function(){this.stop(),this._resetPos(0),this.enabled=!1,this._unbind(p),this._unbind(q),this._unbind(r)},enable:function(){this.enabled=!0},stop:function(){this.options.useTransition?this._unbind("webkitTransitionEnd"):m(this.aniTime),this.steps=[],this.moved=!1,this.animating=!1},zoom:function(a,b,d,e){var f=this,g=d/f.scale;if(!f.options.useTransform)return;f.zoomed=!0,e=e===undefined?200:e,a=a-f.wrapperOffsetLeft-f.x,b=b-f.wrapperOffsetTop-f.y,f.x=a-a*g+f.x,f.y=b-b*g+f.y,f.scale=d,f.refresh(),f.x=f.x>0?0:f.x<f.maxScrollX?f.maxScrollX:f.x,f.y=f.y>f.minScrollY?f.minScrollY:f.y<f.maxScrollY?f.maxScrollY:f.y,f.scroller.style[c+"TransitionDuration"]=e+"ms",f.scroller.style[c+"Transform"]=t+f.x+"px,"+f.y+"px"+u+" scale("+d+")",f.zoomed=!1},isReady:function(){return!this.moved&&!this.zoomed&&!this.animating}},typeof exports!="undefined"?exports.iScroll=v:window.iScroll=v}(),window.iScroll}),define("joshfire-framework/view",["joshlib!vendor/backbone","joshlib!vendor/underscore","joshlib!utils/dollar"],function(a,b,c){var d=a.View.extend({compileTemplate:b.template,initialize:function(a){a?this.data=a.data||{}:this.data={}},render:function(){var a=this;this.generate(function(b,c){c!==!1&&a.setContent(c),a.enhance()})},setContent:function(a){c(this.el).html(""),c(this.el).append(a)},generate:function(a){a(null,"")},wrapContent:function(a){a=a||"";var c=function(a){return a?a.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;"):""};if(!this.el)return"<div>"+a+"</div>";var d="<"+this.el.nodeName.toLowerCase();return b.each(this.el.attributes,function(a){a.value?d+=" "+a.name+'="'+c(a.value)+'"':d+=" "+a.name}),d+=">"+a+"</"+this.el.nodeName.toLowerCase()+">",d},hide:function(){c(this.el).hide()},show:function(){c(this.el).show()},enhance:function(){},setElement:function(a,b){c(this.el)&&c(this.el).unbind(".delegateEvents"+this.cid);var d=a instanceof c?a:c(a);return this.el=d[0],b!==!1&&this.delegateEvents(),this}});return d}),define("joshfire-framework/uielement",["joshlib!view"],function(a){var b=a.extend({});return b}),define("joshfire-framework/adapters/phone/uielement",["joshlib!adapters/none/uielement","joshlib!vendor/iscroll","joshlib!vendor/underscore","joshlib!utils/dollar"],function(a,b,c,d){var e=a.extend({initialize:function(b){this.options.scroller&&d(this.el).css({overflow:"hidden"}),this.options.scrollerSelector&&(this.scrollerSelector=this.options.scrollerSelector),a.prototype.initialize.call(this,b)},enhance:function(){var b=this;if(this.options.scroller){b.insertScroller();var c=b.$("img");c.length&&b.$("img").bind("load",function(){setTimeout(function(){b.iScroller.refresh()},10)})}a.prototype.enhance.call(this)},insertScroller:function(){var a=this;this.hasScroller=!0,a.iScroller&&a.iScroller.destroy();var e=a.el;a.scrollerSelector&&(e=d(a.scrollerSelector,a.el).get(0)||a.el),a.iScroller=new b(e,c.extend({useTransition:!0,onScrollMove:function(){a.$("a").bind("click.iscrollprevent",function(a){a.preventDefault()})},onScrollEnd:function(){setTimeout(function(){a.$("a").unbind("click.iscrollprevent")},100)}},a.options.scrollOptions||{})),document.addEventListener("orientationChanged",function(b){a.iScroller&&a.iScroller.refresh()})}});return e}),define("joshfire-framework/ui/item",["joshlib!uielement","joshlib!utils/dollar","joshlib!vendor/underscore"],function(a,b,c){var d=a.extend({initialize:function(c){c.template?this.template=this.compileTemplate(c.template):c.templateEl&&(this.template=this.compileTemplate(b(c.templateEl).html())),this.setModel(c.model),a.prototype.initialize.call(this,c)},setModel:function(a,b){this.model=a,a&&a.bind("change",this.render,this),b&&this.render()},generate:function(a){if(!this.template)return a(null,"");if(!this.model)return a(null,"");var b={model:this.model,obj:this.model,item:this.model?this.model.toJSON():{}};c.extend(b,this.data),a(null,this.template(b))}});return d}),define("joshfire-framework/ui/listitem",["joshlib!uielement","joshlib!vendor/underscore"],function(a,b){var c=a.extend({initialize:function(b){this.view=b.view,this.offset=b.offset,a.prototype.initialize.call(this,b)},setElement:function(a){this.view.el=a},generate:function(a){this.view.data.offset=this.offset,this.view.generate(a)},render:function(){this.view.render()},setContent:function(a){this.view.setContent(a)},hide:function(){this.view.hide()},show:function(){this.view.show()},enhance:function(){this.view.enhance()}});return c}),define("joshfire-framework/ui/list",["joshlib!uielement","joshlib!ui/listitem","joshlib!ui/item","joshlib!utils/dollar","joshlib!vendor/underscore"],function(a,b,c,d,e){var f=a.extend({initialize:function(f){f.templateEl?this.template=this.compileTemplate(d(f.templateEl).html()):this.template=this.compileTemplate("<ul><%= children %></ul>"),this.UIItemClass=f.UIItemClass||b,this.itemOptions=f.itemOptions||{scroller:!1},this.itemTemplateEl=f.itemTemplateEl,this.itemOptions.templateEl=this.itemOptions.templateEl||this.itemTemplateEl,this.itemOptions.template=this.itemOptions.template||f.itemTemplate,this.contentSelector=f.contentSelector,this.items=[],this.itemFactory=f.itemFactory||function(a,b){var d={model:a,offset:b};return e.extend(d,this.itemOptions),new c(d)},a.prototype.initialize.call(this,f),f.collection&&this.setCollection(f.collection)},setCollection:function(a,b){this.collection&&(this.collection.unbind("change",this.update,this),this.collection.unbind("add",this.update,this),this.collection.unbind("remove",this.update,this),this.collection.unbind("reset",this.update,this),this.collection.unbind("syncstarted",this.syncStartedHandler,this),this.collection.unbind("syncsuccess",this.syncSuccessHandler,this),this.collection.unbind("syncerror",this.syncErrorHandler,this)),this.collection=a,a&&(a.bind("change",this.update,this),a.bind("add",this.update,this),a.bind("remove",this.update,this),a.bind("reset",this.update,this),a.bind("syncstarted",this.syncStartedHandler,this),a.bind("syncsuccess",this.syncSuccessHandler,this),a.bind("syncerror",this.syncErrorHandler,this)),this.update(b)},update:function(a){this.items=new Array(this.collection.length);for(var c=0;c<this.collection.length;c++){var d=this.collection.at(c);this.items[c]=new b({view:this.itemFactory.call(this,d,c),model:d,offset:c})}a&&this.render()},generate:function(a){var b=this.items,c=new Array(b.length),d=0,e=this.template;if(!b.length){var f=e({children:""});a(null,f);return}for(var g=0;g<b.length;g++)((function(f,g){this.generateItem(function(f,h){c[g]=h;if(++d===b.length){var i=e({children:c.join("")});a(null,i)}},f)})).call(this,b[g],g)},generateItem:function(a,b){b.generate(a)},enhance:function(){var b=this.$("li");for(var c=0;c<this.items.length;c++){var e=this.items[c];e.setElement(b[c]),e.enhance()}this.$(".joshfire-link").unbind("click").bind("click",function(a){window.location=d(a.currentTarget).attr("data-joshfire-link-url")}),a.prototype.enhance.call(this)},setContent:function(a){this.contentSelector?this.$(this.contentSelector).html(a):d(this.el).html(a)},syncStartedHandler:function(){d(this.el).addClass("loading")},syncSuccessHandler:function(){d(this.el).removeClass("loading")},syncErrorHandler:function(){d(this.el).removeClass("loading")}});return f}),function(a){var b=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},c=function(a){if(a["@type"]==="VideoObject"||a["@type"]==="AudioObject")return a;var b=["video","audio","associatedMedia"];for(var c=0,d=b.length;c<d;c++){var e=b[c];if(typeof a[e]!="undefined")return a[e]}},d=function(a,b){b=b||{},a=a||{};var c={width:b.width||500,height:b.height||281};a["@type"]==="AudioObject"&&(c.height=b.height||40);if(b.adjustSize){var d=4/3;a.width&&a.height?d=a.width/a.height:a["yt:aspectRatio"]==="widescreen"&&(d=16/9);var e={width:Math.round(c.height*d),height:Math.round(c.width/d)};e.width>c.width+1?c.height=e.height:e.width<c.width-1&&(c.width=e.width)}return c},e=function(a){typeof this.initialize=="function"?this.initialize(a):e.prototype.initialize.call(this,a)};e.extend=function(a){var c=function(a){e.call(this,a)};return b(c.prototype,a),c},b(e.prototype,{initialize:function(a){},toHtml:function(a){typeof a=="function"&&a(null,"",{})}});var f=function(a){if(a.match(/soundcloud/g))return"audio/mp3";var b=a.split(".").pop();switch(b){case"webm":return"video/webm";case"ogv":return"video/ogg";case"mp4":return"video/mp4";case"m4v":return"video/mp4";case"ogg":return"audio/ogg";case"mp3":return"audio/mp3";case"m4a":return"audio/mp4";default:return""}},g=e.extend({initialize:function(a){this.sources=a.sources,this.poster=a.poster,this.width=a.width||500,this.height=a.height||281,this.autoPlay=a.autoPlay||!1},toHtml:function(a){var b=this.poster?' poster="'+this.poster+'"':"",c=this.autoPlay?" autoplay":"",d='<video width="'+this.width+'" height="'+this.height+'" '+b+c+" controls "+'class="video-js vjs-default-skin" data-setup="{}">';for(var e=0;e<this.sources.length;e++){var g=this.sources[e];d+='<source src="'+g+'"  type="'+f(g)+'" />'}d+="</video>",typeof a=="function"&&a(null,d,{width:this.width,height:this.height})}}),h=e.extend({initialize:function(a){this.sources=a.sources,this.poster=a.poster||"",this.width=a.width||500,this.height=a.height||281,this.autoPlay=a.autoPlay||!1},addPolyFill:function(){var a=document.getElementsByTagName("body")[0],b=document.createElement("link"),c=document.createElement("script");b.setAttribute("href","http://vjs.zencdn.net/c/video-js.css"),b.setAttribute("rel","stylesheet"),c.setAttribute("src","http://vjs.zencdn.net/c/video.js"),a.appendChild(b),a.appendChild(c)},toHtml:function(a){var b=this.poster?' poster="'+this.poster+'"':"",c=this.autoPlay?" autoplay":"",d='<video width="'+this.width+'" height="'+this.height+'" '+b+c+" controls"+' class="video-js vjs-default-skin" data-setup="{}">';for(var e=0;e<this.sources.length;e++){var g=this.sources[e];d+='<source src="'+g+'"  type="'+f(g)+'" />'}d+="</video>",typeof window!="undefined"&&typeof window.VideoJS=="undefined"&&this.addPolyFill(),typeof a=="function"&&a(null,d,{width:this.width,height:this.height})}}),i=e.extend({initialize:function(a){this.sources=a.sources,this.width=a.width||500,this.height=a.height||40,this.autoPlay=a.autoPlay||!1},iCanHazAudioTag:function(a){if(!document)return!1;var b=document.createElement("audio");return b.canPlayType},toHtml:function(a){var b="";if(this.sources&&this.sources.length){for(var c=0;c<this.sources.length;c++)if(this.iCanHazAudioTag(this.sources[c])){var d=this.autoPlay?" autoplay":"";b='<audio controls src="'+this.sources[c]+'"'+d+"></audio>";break}b||(b='<a href="'+this.sources[0]+'" target="_blank">Play</a>')}typeof a=="function"&&a(null,b,{})}}),j=e.extend({initialize:function(a){this.sources=a.sources,this.width=a.width||500,this.height=a.height||281,this.autoPlay=a.autoPlay||!1},toHtml:function(a){var b="mediaplayerlib-mediaelement-video-"+j.nextId++,c=this.poster?' poster="'+this.poster+'"':"",d=this.autoPlay?" autoplay":"",e='<video width="'+this.width+'" height="'+this.height+'" '+c+d+" controls"+' id="'+b+'">';for(var f=0;f<this.sources.length;f++){var g=this.sources[f];e+='<source src="'+g+'" />'}e+="</video>",e+="<script>",e+='$("#'+b+'").mediaelementplayer({',e+="playerWidth: "+this.width+",",e+="playerHeight: "+this.height,e+="});",e+="</script>",typeof a=="function"&&a(null,e,{width:this.width,height:this.height})}});j.nextId=0;var k=e.extend({initialize:function(a){this.options=a},toHtml:function(b){var c=null;for(var d=0;d<k.endPoints.length;d++)this.options.url.match(k.endPoints[d].regexp)&&(c=k.endPoints[d]);if(!c){typeof b=="function"&&b(null,null);return}if(typeof module!="undefined"){var e=c.url(null,this.options),f=require("http"),g=require("url"),h=g.parse(e),i={host:h.hostname,path:h.pathname+h.search,port:80,method:"GET"},j=f.request(i,function(a){var c="";a.on("data",function(a){c+=a}),a.on("end",function(){typeof b!="undefined"&&b(null,JSON.parse(c).html)}),a.on("close",function(a){typeof b!="undefined"&&b(a)})});j.on("error",function(a){typeof b!="undefined"&&b(a)}),j.end()}else{var l=k.cbName(),g=c.url(l,this.options),m=document.getElementsByTagName("body")[0],n=document.createElement("script");a[l]=function(c){m.removeChild(n),delete a[l],typeof b=="function"&&b(null,c.html)},n.setAttribute("src",g),m.appendChild(n)}}});k.endPoints=[{regexp:/soundcloud\.com/i,url:function(a,b){var c=null;return a?c="http://soundcloud.com/oembed?format=js&callback="+a+"&url="+encodeURIComponent(b.url):c="http://soundcloud.com/oembed?format=json&url="+encodeURIComponent(b.url),b.width&&(c+="&maxwidth="+b.width),b.height&&(c+="&maxheight="+b.height),c}},{regexp:/vimeo\.com/i,url:function(a,b){var c=null;return a?c="http://vimeo.com/api/oembed.json?callback="+a+"&url="+encodeURIComponent(b.url):c="http://vimeo.com/api/oembed.json?url="+encodeURIComponent(b.url),b.width&&(c+="&width="+b.width),b.height&&(c+="&height="+b.height),c}},{regexp:/slideshare\.net/i,url:function(a,b){var c=null;return a?c="http://www.slideshare.net/api/oembed/2?format=jsonp&callback="+a+"&url="+encodeURIComponent(b.url):c="http://www.slideshare.net/api/oembed/2?url="+encodeURIComponent(b.url),b.width&&(c+="&maxwidth="+b.width),b.height&&(c+="&maxheight="+b.height),c}}],k.numCbName=0,k.cbName=function(){return"OEmbedCallBack"+k.numCbName++};var l=e.extend({initialize:function(a){this.url=a.url,this.width=a.width||500,this.height=a.height||281;var b=this.url.match(/youtube/gi),c=this.url.match(/vimeo/gi);a.html5&&b&&(this.url.indexOf("?")===-1?this.url+="?html5=1":this.url+="&html5=1"),a.autoPlay&&(b||c)&&(this.url.indexOf("?")===-1?this.url+="?autoplay=1":this.url+="&autoplay=1")},toHtml:function(a){var b='<iframe src="'+this.url+'" width="'+this.width+'" height="'+this.height+'" frameborder="0"></iframe>';typeof a=="function"&&a(null,b,{width:this.width,height:this.height})}}),m=e.extend({initialize:function(a){this.url=a.url,this.publisher=a.publisher,this.width=a.width||500,this.height=a.height||281},toHtml:function(a){var b=this.url||"",c="",d="",e=function(){var a=function(){return((1+Math.random())*65536|0).toString(16).substring(1)};return"mediaplayerlib-"+a()+a()+a()};d=e(),this.publisher==="Ooyala"?(b+=(b.indexOf("?")===-1?"?":"&amp;")+"width="+encodeURIComponent(this.width)+"&amp;height="+encodeURIComponent(this.height),c='<div id="'+d+'"></div>'+'<script type="text/javascript">'+'document.getElementById("'+d+'").appendChild(document.createElement("script"));'+'window.ooyalaActiveScript = document.getElementById("'+d+'").firstChild;'+"</script>"+'<script type="text/javascript" src="'+b+'"></script>'):c='<script type="text/javascript" src="'+b+'"></script>',typeof a=="function"&&a(null,c,{width:this.width,height:this.height})}}),n=e.extend({toHtml:function(a){typeof a=="function"&&a(new Error("Unknown media type."),"Unknown media type.")}}),o=function(){};b(o.prototype,{execute:function(a,b){return new n(b)}}),o.extend=function(a){var c=function(a){o.call(this,a)};return b(c.prototype,a),c};var p=o.extend({execute:function(a,e){var f,g=c(a)||{},i=d(g,e);b(e,i);if(g["@type"]==="VideoObject")if(g.playerType==="iframe")b(e,{url:g.embedURL}),f=new l(e);else if(g.playerType==="script")b(e,{url:g.embedURL,publisher:g.publisher?g.publisher.name:null}),f=new m(e);else if(g.contentURL){var j=null;g.image&&g.image.contentURL&&(j=g.image.contentURL),b(e,{poster:j,sources:[g.contentURL]}),f=new h(e)}return f||new n}}),q=o.extend({execute:function(a,e){var f,h=c(a)||{},j=d(h,e);b(e,j);if(h.playerType==="iframe")b(e,{url:h.embedURL,html5:!0}),f=new l(e);else if(h.playerType==="script")b(e,{url:h.embedURL,html5:!0,publisher:h.publisher?h.publisher.name:null}),f=new m(e);else if(h["@type"]==="VideoObject"){if(h.contentURL){var k=null;h.image&&(k=h.image.contentURL),b(e,{poster:k,sources:[h.contentURL]}),f=new g(e)}}else h["@type"]==="AudioObject"&&h.contentURL&&(b(e,{sources:[h.contentURL]}),f=new i(e));return f}}),r=o.extend({execute:function(a,e){var f=c(a)||{},g=d(f,e);b(e,g);var h;if(a["@type"]==="VideoObject"){if(typeof a.contentURL!="undefined"){var i=null;f.image&&(i=f.image.contentURL),b(e,{poster:i,sources:[a.contentURL]}),h=new j(e)}}else a["@type"]==="AudioObject"&&typeof a.contentURL!="undefined"&&b(e,{sources:[a.contentURL]});return h}}),s=o.extend({execute:function(a,c){var d;return typeof a.url!="undefined"&&(b(c,{url:a.url}),d=new k(c)),d}}),t=function(){this.strategies={def:new p,html5:new q,mediaElement:new r,oembed:new s}};b(t.prototype,{resolve:function(a,b){b=b||{};var c;if(typeof b.strategy!="undefined"&&typeof this.strategies[b.strategy]!="undefined"){var d=this.strategies[b.strategy];c=d.execute(a,b)}return c||this.strategies.def.execute(a,b)},insertFragment:function(a,b){function d(a,b){b(a);for(var c in a.childNodes)d(a.childNodes[c],b)}function e(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()}function f(a){var b=a.text||a.textContent||a.innerHTML||"",c=a.getAttribute("src"),d=document.getElementsByTagName("head")[0]||document.documentElement,e=document.createElement("script");e.type="text/javascript",c&&e.setAttribute("src",c),b&&e.appendChild(document.createTextNode(b)),d.insertBefore(e,d.firstChild),a.parentNode&&a.parentNode.removeChild(a)}var c=null;Object.prototype.toString.call(b)==="[object String]"?c=document.getElementById(b):c=b,c.innerHTML=(""+a).trim();var g=[],h=null;d(c,function(a){a.nodeName&&a.nodeName.toUpperCase()==="SCRIPT"&&(!a.type||a.type==="text/javascript")&&g.push(a)});for(h in g)f(g[h])},insert:function(a,b,c,d){var e=this,f=this.resolve(a,b).toHtml(function(a,b){e.insertFragment(b,c),typeof d=="function"&&d(null)})}}),typeof Joshfire!="undefined"&&typeof Joshfire.define!="undefined"?Joshfire.define([],function(){return new t}):typeof define!="undefined"?define("joshfire-framework/utils/mediaplayerlib",[],function(){return new t}):a.mediaFactory=new t}(typeof module!="undefined"?module.exports:window),define("joshfire-framework/ui/factorymedia",["joshlib!ui/item","joshlib!utils/mediaplayerlib","joshlib!utils/dollar","joshlib!vendor/underscore"],function(a,b,c,d){var e=a.extend({initialize:function(b){this.mediaOptions=b.mediaOptions||{},a.prototype.initialize.call(this,b)},generate:function(e){var f=/^([0-9]{1,3})%$/,g=null,h=0,i=d.clone(this.mediaOptions);if(!this.model)return e(null,"");i.width&&d.isString(i.width)&&(g=i.width.match(f),g&&(h=parseInt(g[1],10),this.options.width?i.width=this.options.width*h/100:i.width=c(this.el).width()*h/100,i.width=Math.floor(i.width))),i.height&&d.isString(i.height)&&(g=i.height.match(f),g&&(h=parseInt(g[1],10),this.options.height?i.height=this.options.height*h/100:i.height=c(this.el).height()*h/100,i.height=Math.floor(i.height)));var j=b.resolve(this.model.toJSON(),i);j.toHtml(d.bind(function(b,c,f){if(this.template)d.extend(this.data,{media:{html:c,metadata:f},width:this.options.width,height:this.options.height}),a.prototype.generate.call(this,e);else return e(null,c)},this))}});return e}),define("js/views",["joshlib!utils/dollar","joshlib!vendor/underscore","joshlib!uielement","joshlib!ui/item","joshlib!view","joshlib!ui/list","joshlib!ui/factorymedia"],function(a,b,c,d,e,f,g){var h={app:e.extend({el:"#app",$el:a("#app"),content:null,sidebar:null,initialize:function(a){this.sidebar=new h.sidebar,this.content=new h.content}}),sidebar:e.extend({el:"#sidebar",$el:a("#sidebar"),events:{"touchend .back":"goBack"},setTitle:function(b){var c=this;a("header h2",c.$el).html(b.title),a("header .curChapter",c.$el).attr("href","#/view/"+b.id)},goBack:function(){return document.location.hash="/view",!1}}),content:e.extend({el:"#content",$el:a("#content")}),mysteryPane:e.extend({el:"<div></div>",$el:null,child:null,backButton:'<button class="back">back</button>',events:{},initialize:function(b){var c=this;c.$el=a(c.el),c.$el.attr("id",b.paneOptions.id),c.$el.attr("class",b.paneOptions.classes),c.$el.hide(),a("#"+b.paneOptions.container).append(c.$el),b.data.get("@type")=="VideoObject"?(c.child=new g({model:b.data,width:760,height:460,templateEl:"#media-template",mediaOptions:{strategy:"html5",width:"100%",height:"100%",adjustSize:!0},el:c.$el[0]}),c.child.render()):b.data.get("@type")=="MusicRecording"?(c.child=new g({model:b.data,templateEl:"#media-template",mediaOptions:{strategy:"html5",adjustSize:!0,autoPlay:!0},el:c.$el[0]}),c.child.render()):b.data.get("@type")=="ImageObject"?(c.child=new h.mysteryImage({model:b.data,opt:b.paneOptions,$parent:c.$el}),c.child.renderTitle(),setTimeout(function(){c.child.render()},900)):b.data.get("@type")=="Article/Status"?(c.child=new h.mysteryArticle({model:b.data,opt:b.paneOptions,$parent:c.$el}),c.child.render()):(c.child=new h.mysteryBlogPost({model:b.data,opt:b.paneOptions,$parent:c.$el}),c.child.render());if(b.data.get("@type")=="VideoObject"){var d=a("iframe",c.$el).clone();a(".maincontent").css({height:d.attr("height")+"px"}),a("iframe",c.$el).remove(),a(".maincontent",c.$el).append('<div style="height:'+d.attr("height")+'px;" class="loader"></div>'),setTimeout(function(){d.attr("width",a("#content").width()-100),a(".maincontent",c.$el).append(d),a("iframe",c.$el).on("load",function(){a(".maincontent .loader",c.$el).anim({opacity:0},.6,"linear",function(){a(this).remove()})})},800)}b.paneOptions.backButton&&(c.child.$el.prepend(c.backButton),a(".back",c.$el).bind("touchend",c.goBack))},goBack:function(a){var b=document.location.hash.split("/");return b.pop(),b=b.join("/"),document.location.hash=b,!1}}),mysteryImage:e.extend({el:'<div class="mysteryImage"></div>',$el:null,template:"#image-template",titleTemplate:'<h4><%=title%></h4><div class="loader"></div>',$parent:null,theScroller:null,initialize:function(b){var c=this;this.$parent=b.$parent,this.$el=a(this.el),this.template=a("#image-template").html()},renderTitle:function(){var a=this;a.$el.append(b.template(a.titleTemplate,{title:a.model.get("name")})),a.$parent.append(a.$el)},generate:function(a){var c=this;a(null,b.template(c.template,{item:c.model.toJSON()}))},setContent:function(b){var c=this,d=a(b),e=a('<img src="'+c.model.get("contentURL")+'" />');c.$el.append(b),a(".maincontent",c.$el).append(e),a(".innerContainer",c.$el).css({opacity:0}),e.on("load",function(){a(".loader",c.$el).remove(),a(".innerContainer",c.$el).anim({opacity:1},.4,"ease-in-out")})}}),mysteryArticle:e.extend({el:'<div class="articleStatus"></div>',$el:null,templateEl:"#article-template",titleEl:null,$parent:null,scrollable:!1,theScroller:null,initialize:function(b){var c=this;this.$parent=b.$parent,this.$el=a(this.el),this.scrollable=b.opt.scrollable,this.templateEl=a(this.templateEl),this.model.get("articleBody")&&(this.model.attributes.articleBody=this.model.get("articleBody").replace('src="//','src="http://'),this.model.attributes.articleBody=this.model.get("articleBody").replace(/href="/gi,'target="_blank" href="'))},generate:function(a){var c=this;a(null,b.template(c.templateEl.html(),{title:c.titleEl,item:c.model.toJSON(),scrollId:"scroll-"+c.model.get("guid")}))},setContent:function(b){var c=this,d=a(b);a("img",d).hide(),c.$el.append(b),c.$parent.append(c.$el);return}}),mysteryBlogPost:e.extend({el:'<div class="blogPost"></div>',$el:null,template:'<%=title%><div class="blogpaneInnerContainer innerContainer" id="<%=scrollId%>"><article><%=model.get("articleBody")%></article></div>',titleTemplate:"<h4><%=title%></h4>",subTitleTemplate:"<h5><%=title%></h4>",rubricTitleTemplate:"<h6><%=title%></h4>",titleEl:null,$parent:null,scrollable:!1,theScroller:null,initialize:function(c){var d=this;this.$parent=c.$parent,this.$el=a(this.el),this.scrollable=c.opt.scrollable,this.model.get("articleBody")&&(this.model.attributes.articleBody=this.model.get("articleBody").replace('src="//','src="http://'),this.model.attributes.articleBody=this.model.get("articleBody").replace(/href="/gi,'target="_blank" href="')),c.opt.title&&(c.opt.titleType=="small"?d.titleEl=b.template(this.rubricTitleTemplate,{title:c.opt.title}):c.opt.titleType=="medium"?d.titleEl=b.template(this.subTitleTemplate,{title:c.opt.title}):c.opt.titleType=="big"?d.titleEl=b.template(this.titleTemplate,{title:c.opt.title}):d.titleEl=b.template(this.titleTemplate,{title:c.opt.title}))},generate:function(a){var c=this;a(null,b.template(c.template,{title:c.titleEl,model:c.model,scrollId:"scroll-"+c.model.get("guid")}))},setContent:function(b){var c=this,d=a(b);a("img",d).hide(),c.$el.append(b),c.$parent.append(c.$el)},enhance:function(){var a=this}}),tocPane:e.extend({el:"<div></div>",$el:null,child:null,innerContainer:'<div id="logo"><div class="icon"></div><div class="spots"></div><div class="flare"></div><div class="flareicon"></div></div><div id="intropicture"></div><div id="introtext"></div><div class="listpaneInnerContainer"></div>',listContainer:'<div class="listPane"></div>',initialize:function(b){var c=this;c.$el=a(c.el),c.$el.attr("id",b.paneOptions.id),c.$el.attr("class",b.paneOptions.classes),c.innerContainer=a(c.innerContainer),c.listContainer=a(c.listContainer),c.innerContainer.last().append(c.listContainer),c.$el.append(c.innerContainer),a("#"+b.paneOptions.container).append(c.$el),c.$el.hide(),c.child=new h.mysteryList({itemFactory:function(a,c){return b.paneOptions.itemType=="sidebar"?new h.mysterySidebarItem({model:a}):b.paneOptions.itemType=="home"?new h.mysteryHomeItem({model:a}):new h.mysteryItem({model:a})},collection:b.data,itemOptions:{$parent:c.listContainer,listId:b.paneOptions.listId,listClasses:b.paneOptions.listClasses}}),c.child.render(),a("#"+b.paneOptions.listId).hide();if(Joshfire&&Joshfire.factory){var d=Joshfire.factory.config.template.options.backgroundurl;d&&a("#"+b.paneOptions.listId).css({background:"#F8F6F4 url("+d+") no-repeat center center",backgroundSize:"cover"});var e=Joshfire.factory.config.app.logo;e&&(a("#logo .icon").css({background:"transparent url("+e.contentURL+") no-repeat center center"}),a("#logo .flareicon").css({background:"transparent url("+e.contentURL+") no-repeat center center"}))}},showAnimated:function(){var a=this;a.$el.show().addClass("shown").addClass("anim"),setTimeout(function(b){a.videoEnded(b)},1600)},videoEnded:function(b){var c=this;a("#tableofcontent").show(),c.$el.addClass("anim2"),a("#introtext").remove(),setTimeout(function(b){a(".anim").removeClass("anim")},1600)}}),mysteryListPane:e.extend({el:"<div></div>",$el:null,child:null,titleTemplate:"<h4><%=title%></h4>",innerContainer:'<div class="listpaneInnerContainer innerContainer"></div>',descriptionTemplate:'<article class="description"><%=description%></article>',listContainer:'<div class="listPane"></div>',backButton:'<button class="back">back</button>',theScroller:null,events:{},initialize:function(c){var d=this;d.$el=a(d.el),d.$el.attr("id",c.paneOptions.id),d.$el.attr("class",c.paneOptions.classes),d.innerContainer=a(d.innerContainer),d.innerContainer.attr("id","scroll-"+c.paneOptions.id),c.paneOptions.title&&d.$el.append(b.template(this.titleTemplate,{title:c.paneOptions.title})),d.listContainer=a(d.listContainer),d.innerContainer.append(d.listContainer),d.$el.append(d.innerContainer),a("#"+c.paneOptions.container).append(d.$el),d.$el.hide(),d.child=new h.mysteryList({itemFactory:function(a,b){return c.paneOptions.itemType=="sidebar"?new h.mysterySidebarItem({model:a}):c.paneOptions.itemType=="home"?new h.mysteryHomeItem({model:a}):new h.mysteryItem({model:a})},collection:c.data,itemOptions:{$parent:d.listContainer,listId:c.paneOptions.listId,listClasses:c.paneOptions.listClasses}}),d.child.render(),c.paneOptions.backButton&&(d.$el.prepend(d.backButton),a(".back",d.$el).on("touchend",d.goBack))},goBack:function(a){var b=document.location.hash.split("/");return b.pop(),b=b.join("/"),document.location.hash=b,!1}}),mysteryList:f.extend({setContent:function(b){a("ul",this.itemOptions.$parent).remove();var c=this,d=a(b),e=this.itemOptions,f=a("li",d);f.length>5&&(a("li",d).remove(),d.append(f.slice(0,5)),setTimeout(function(){var a=Math.round((f.length-5)/20),b=0,e=setInterval(function(){d.append(f.slice(b*20,b*20+20));if(b==a){c.enhance(),clearInterval(e);return}b++},50)},800)),e.$parent.append(d),a("ul",e.$parent).attr("id",e.listId||""),a("ul",e.$parent).attr("class",e.listClasses||"")},enhance:function(){var b=this;a("a",this.itemOptions.$parent).each(function(a){var c=new Tap(this);this.removeEventListener("tap",b.taphandle),this.addEventListener("tap",b.taphandle),this.removeEventListener("click",b.clickhandle),this.addEventListener("click",b.clickhandle)})},taphandle:function(a){var b=a.target;while(!b.href)b=b.parentElement;return document.location=b.href,a.preventDefault(),a.stopPropagation(),!1},clickhandle:function(a){return a.preventDefault(),a.stopPropagation(),!1}}),mysteryItem:e.extend({template:'<li><a class="listitemlink" href="<%=model.get("path")%>"><h3><%=model.get("name")%></h3><% if(desc) {%><p><%=desc.get("description")%></p><%}%></a></li>',initialize:function(){e.prototype.initialize.call(this)},generate:function(a){if(this.model.get("isChapterIntro"))a(null,"");else{var c=this.model.get("children").getDescriptionPost();a(null,b.template(this.template,{model:this.model,desc:c}))}}}),mysteryHomeItem:e.extend({template:'<li><a class="homelistitemlink" href="<%=model.get("path")%>"><h3><%=model.get("name")%></h3></a></li>',initialize:function(){e.prototype.initialize.call(this)},generate:function(a){var c=this.model.get("children").getDescriptionPost();a(null,b.template(this.template,{model:this.model,desc:c}))}}),mysterySidebarItem:e.extend({template:'<li style="<%=style%>" id="sidebar-<%=model.get("guid")%>"><a class="sidelistitemlink" class="sidebarlink" href="<%=model.get("path")%>"><span class="count"><p><%=index%></p></span><div class="tablecell"><h3><%=model.get("name")%></h3></div></a></li>',initialize:function(){e.prototype.initialize.call(this)},generate:function(a){var c=this.model.collection.indexOf(this.model)+1,d="";a(null,b.template(this.template,{index:c,model:this.model,style:d}))},setSelected:function(b){a(".selected").removeClass("selected"),a(this).addClass("selected")}}),popup:e.extend({el:'<div id="popup"></div>',$el:null,template:'<span class="close"></span><div class="content"><%=content%></div>',videoTemplate:'<video id="videoplayer" controls="controls" width="<%=width%>" height="<%=height%>" webkit-playsinline><source src="<%=src%>" type="video/mp4" /></video>',initialize:function(){this.$el=a(this.el),this.render()},setImage:function(b){var c=this;this.$el.show().css({opacity:"0",display:"block",background:"#FFF"}),a(".content",c.$el).html(b),this.$el.attr("class","playimage"),setTimeout(function(){c.$el.anim({opacity:1},.4,"linear")},0)},setVideo:function(c,d){var e=this,f={width:974,height:718};f=b.extend(f,d),this.$el.css({opacity:"0",display:"block",background:"#000"}),this.$el.attr("class","playvideo"),setTimeout(function(){a(".content",e.$el).html(b.template(e.videoTemplate,{src:c,width:f.width,height:f.height})),e.$el.anim({opacity:1},.4,"linear")},0)},setText:function(b){this.$el.show().css({opacity:0}),a(".content",this.$el).html(b),this.$el.anim({opacity:1},.4,"linear")},generate:function(a){a(null,b.template(this.template,{content:""}))},setContent:function(b){a("#popup").length||a("#popup").remove(),this.$el.append(b),a("#app").append(this.$el)},enhance:function(){var b=this;this.$el.hide(),a(".close",this.$el).bind("click",function(c){b.$el.anim({opacity:0},.4,"linear",function(){a(".content",b.$el).empty(),b.$el.css({opacity:"1",display:"none"})})})}})};return h}),define("js/models",["joshlib!vendor/backbone","js/views"],function(a,b){var c={ApplicationTree:a.Model.extend({defaults:{view:null,children:null,"@type":"Chapter"},initialize:function(){this.set({children:new c.Elements})},addBranch:function(a){a&&(a["@type"]||(a["@type"]="Chapter"),a.path="#/view",this.get("children").add(new c.Element(a)))}}),Element:a.Model.extend({idProperty:"_id",defaults:{_id:0,name:"posttitle",slug:"postslug",dateAdded:"",dateModified:"",parent:0,content:"",children:null,"@type":"Thing",guid:null,path:0},firstLoading:!1,initialize:function(a){var b=this;this.set({id:a.ID||a.id,_id:a.ID||a.id,name:a.name,content:a.articleBody,slug:a.post_name,children:new c.Elements,path:""}),this.set({id:this.cid}),this.set({guid:this.cid}),this._find=a.find,this.set({path:a.path+"/"+this.get("guid")}),typeof this._find=="function"&&this.find({},function(){b.firstLoading=!0})},find:function(a,b){var d=this;this._find(a,function(a,e){for(var f in e.entries)e.entries[f].path=d.get("path"),d.get("children").add(new c.Element(e.entries[f]));typeof d._onDataLoaded=="function"&&d._onDataLoaded(d.get("children")),b(a,d.get("children"))})},_find:null,_onDataLoaded:null,_populateChildren:function(a){for(var b in a)a.hasOwnProperty(b)&&(a[b].path=this.get("path"),this.get("children").add(new c.Element(a[b])))},_populateMedias:function(a){for(var b in a)a.hasOwnProperty(b)&&this.medias.add(new c.Media(a[b]))}}),Elements:a.Collection.extend({comparator:function(a){var b=/(\d+)/.exec(a.get("name"));return b&&b.length?(b=b.shift(),parseInt(b)):0},getFirstChapter:function(){for(var a in this.models)if(this.models[a].get("@type")=="Chapter")return this.models[a];return!1},getFirstPost:function(){for(var a in this.models)if(this.models[a].get("@type")=="BlogPosting")return this.models[a];return!1},getDescriptionPost:function(){for(var a in this.models)if(this.models[a].get("isChapterIntro"))return this.models[a];return!1}})};return c}),define("js/dataManager",["js/models","joshlib!utils/dollar","joshlib!vendor/underscore"],function(a,b,c){var d={appTree:null,dataFile:null,initialize:function(){return this.appTree=new a.ApplicationTree,this},loadDataTree:function(a){var d=this;d.dataFile?b.getJSON(d.dataFile,function(b){c.each(b,function(a){d.appTree.addBranch(a)}),a(d.appTree)}):typeof a=="function"&&a(d.appTree)},getDataFromPath:function(a){var b=a.split("/"),c=this.appTree;for(var d=0;d<b.length;d++)c=c.get("children").get(b[d]);return c},getAppConfig:function(){var a=localStorage.getItem("selectedConfig")-1,b=localStorage.getItem("config");return b=JSON.parse(b),b?b[a].formElements:!1}};return d.initialize()}),define("js/uiManager",["joshlib!utils/dollar","joshlib!vendor/underscore","js/views"],function(a,b,c){var d={app:null,popup:null,router:null,staticViews:[],contentPanes:{},sidebarPane:null,currentPart:"",initialize:function(b){this.router=b,this.staticViews.app=new c.app,this.popup=new c.popup,window.popup=this.popup,a(window).on("resize",function(){if(a("#content").hasClass("shrinked")){var b=a(window).width();b-=a("#sidebar").width(),a("#content").css({width:b})}})},setContentView:function(a,d){if(this.contentPanes[d.id]&&d.id=="contentRoot")return this.contentPanes[d.id];if(d.id=="contentRoot")return this.contentPanes[d.id]=new c.tocPane({data:a.get("children"),paneOptions:d}),this.contentPanes[d.id];if(a.get("@type")=="Chapter"){if(a.get("children").length==1){var e=b.first(a.get("children").models);e.get("@type")=="BlogPosting"?this.contentPanes[d.id]=new c.mysteryPane({data:e,paneOptions:d}):this.contentPanes[d.id]=new c.mysteryListPane({data:a.get("children"),paneOptions:d})}else this.contentPanes[d.id]=new c.mysteryListPane({data:a.get("children"),paneOptions:d});return this.contentPanes[d.id]}return this.contentPanes[d.id]=new c.mysteryPane({data:a,paneOptions:d}),this.contentPanes[d.id]},getContentView:function(a){return this.contentPanes[a]},setSidebarView:function(a,b){return a.get("@type")=="Chapter"?(this.sidebarPane=new c.mysteryListPane({data:a.get("children"),paneOptions:b}),this.sidebarPane.show(),this.staticViews.app.sidebar.setTitle({title:a.get("name"),id:a.get("guid")}),this.sidebarPane):!1},clearSidebar:function(){a(".list",this.staticViews.app.sidebar.$el).html("")},setSelectedSidebarItem:function(b){a("#sidebar .selected").removeClass("selected"),a("#sidebar-"+b).addClass("selected")},slideContentPane:function(b,c,d){var e=this,f=a(".shown"),g="",h="";c.direction&&c.direction=="left"?(g="raway",h="laway"):c.direction&&c.direction=="right"?(g="laway",h="raway"):c.direction&&c.direction=="bottom"?(g="taway",h="baway"):c.direction&&c.direction=="top"&&(g="baway",h="taway"),this.contentPanes[b].$el.attr("class","notransition "+g).addClass(g),this.contentPanes[b].$el.show(),f.attr("class",h+" shown").removeClass("shown"),e.contentPanes[b].$el.removeClass("notransition").addClass("shown"),setTimeout(function(){f.attr("id")!="contentRoot"&&f.remove(),typeof d!="undefined"&&d()},500)},setHomeLayout:function(b){var c=this;a("#content").css({width:"100%"}),c.staticViews.app.sidebar.$el.removeClass("visible"),c.staticViews.app.content.$el.removeClass("shrinked"),setTimeout(function(){typeof b!="undefined"&&b()},1e3)},setRegularLayout:function(){var b=this,c=a(window).width()-b.staticViews.app.sidebar.$el.width();a("#content").css({width:c}),b.staticViews.app.sidebar.$el.addClass("visible"),b.staticViews.app.content.$el.addClass("shrinked")},setGlobalConfig:function(b){b.app.name&&(a("title").html(b.app.name),b.app.icon&&a("#thefavicon").attr("href",b.app.icon.contentURL),a("#tableofcontent").css({background:"url("+b.template.options.backgroundurl+")"}))},showPart:function(a){for(var b in this.staticViews)b==a?(this.staticViews[b].show(),this.currentPart=b):this.staticViews[b].hide()}};return d}),define("js/router",["joshlib!router","js/dataManager","js/uiManager","js/views","joshlib!utils/onready"],function(a,b,c,d,e){var f=a({routes:{".*":"defaultRoute","/":"viewHome","/view":"viewHome","/view/:sidebar":"viewSidebar","/view/:sidebar/:content":"viewFirstLevel","/view/:sidebar/:content/*path":"viewSomething","/update-deal/:id":"viewDeal"},initialize:function(){var a=this;c.initialize(this),c.showPart("app"),e(function(){a._loadData(function(a){if(Joshfire.factory){c.setGlobalConfig(Joshfire.factory.config);var b=Joshfire.factory.getDataSource("main");if(b&&typeof b.children!="undefined")for(var d in b.children)b.children.hasOwnProperty(d)&&(b.children[d].name=Joshfire.factory.config.template.options.tabs[d],a.addBranch(b.children[d]))}})})},firstLaunch:!0,loadStarted:!1,loadFinished:!1,previousContentIndex:0,previousContentLevel:0,previousContentId:0,defaultRoute:function(){this.navigate("/",!0)},lockRoute:function(a){$("#codeform",self.$el).prepend('<input type="password" id="code" name="code">'),c.showPart("lock")},viewDeal:function(a){c.currentPart!="config"&&c.showPart("config"),c.staticViews.config.showTab(a),c.staticViews.config.getFormData()},viewHome:function(){var a=this;a._onDataLoaded=function(){var d=b.appTree;if(a.firstLaunch){a.firstLaunch=!1;var e=c.setContentView(d,{container:"content",id:"contentRoot",listId:"tableofcontent",itemType:"home"});c.getContentView("contentRoot").showAnimated()}else{if($("#contentRoot").hasClass("shown"))return;$(".theplayer",".shown").remove(),c.setHomeLayout(function(){c.slideContentPane("contentRoot",{direction:"right"})})}a.previousContentLevel=0},typeof b.appTree!==undefined&&b.appTree&&(a._onDataLoaded(),a._onDataLoaded=null)},viewSidebar:function(a){var d=this;if(this.firstLaunch){Backbone.history.navigate("/view",!0);return}var e=b.getDataFromPath(a);e._onDataLoaded=function(b){c.showPart("app"),c.clearSidebar(),c.setSidebarView(e,{container:"sidebar .list",id:a,classes:"sidebarlist",itemType:"sidebar"});var f=b.first(),g=c.setContentView(f,{container:"content",id:f.get("guid"),title:f.get("name"),showDescription:!0,titleType:"big",scrollable:!0});c.setSelectedSidebarItem(f.get("guid"));if(d.previousContentLevel==2)c.slideContentPane(f.get("guid"),{direction:"bottom"});else{var h="left";d.previousContentLevel>2&&(h="right"),g.$el.hasClass("shown")||c.slideContentPane(f.get("guid"),{direction:h},function(){c.setRegularLayout()})}d.previousContentIndex=0,d.previousContentLevel=1},e.firstLoading&&(e._onDataLoaded(e.get("children")),e._onDataLoaded=null)},viewFirstLevel:function(a,d){var e=this;if(this.firstLaunch){Backbone.history.navigate("/view",!0);return}e._onDataLoaded=function(){var f=b.getDataFromPath(a+"/"+d),g=c.setContentView(f,{container:"content",id:f.get("guid"),title:f.get("name"),titleType:"big",showDescription:!0,scrollable:!0});c.setSelectedSidebarItem(f.get("guid"));var h=f.collection.indexOf(f),i="";i=h<e.previousContentIndex?"bottom":"top",e.previousContentLevel>2?!g.$el.hasClass("shown")&&e.previousContentId==d?c.slideContentPane(f.get("guid"),{direction:"right"}):!g.$el.hasClass("shown")&&e.previousContentId!=d&&c.slideContentPane(f.get("guid"),{direction:i}):g.$el.hasClass("shown")||c.slideContentPane(f.get("guid"),{direction:i}),e.previousContentIndex=h,e.previousContentLevel=2,e.previousContentId=d},typeof b.appTree!==undefined&&b.appTree&&(e._onDataLoaded(),e._onDataLoaded=null)},viewSomething:function(a,d,e){var f=this;if(this.firstLaunch){Backbone.history.navigate("/view",!0);return}f._onDataLoaded=function(g){var h=b.getDataFromPath(a+"/"+d+"/"+e),i="big";e.split("/").length>1?i="small":i="medium",c.setContentView(h,{container:"content",id:h.get("guid"),backButton:!0,showDescription:!0,title:h.get("name"),titleType:i,scrollable:!0});var j="left";f.previousContentLevel>2+e.split("/").length&&(j="right"),c.slideContentPane(h.get("guid"),{direction:j}),f.previousContentLevel=2+e.split("/").length},typeof b.appTree!==undefined&&b.appTree&&(f._onDataLoaded(),f._onDataLoaded=null)},_loadData:function(a){var c=this;c.loadStarted||(c.loadStarted=!0,b.loadDataTree(function(b){c.loadFinished=!0,typeof a=="function"&&a(b),typeof c._onDataLoaded=="function"&&c._onDataLoaded(b)}))},_onDataLoaded:null});return f}),define("app",["joshlib!utils/onready","js/router"],function(a,b){a(function(){b.historyStart(),document.addEventListener("deviceready",function(){},!1),document.addEventListener("pause",function(){},!1),document.addEventListener("resume",function(){},!1)})})